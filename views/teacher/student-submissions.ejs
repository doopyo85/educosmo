<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>학생 제출물 관리</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>
<body>
    <%- include('../partials/header') %>
    
    <div class="container mt-5">
        <h2><i class="bi bi-folder-check me-2"></i>학생 제출물 관리</h2>
        
        <ul class="nav nav-tabs mb-4">
            <li class="nav-item">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#entry">Entry</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#scratch">Scratch</button>
            </li>
        </ul>
        
        <div class="tab-content">
            <div class="tab-pane fade show active" id="entry">
                <div id="entry-list"></div>
            </div>
            <div class="tab-pane fade" id="scratch">
                <div id="scratch-list"></div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        async function loadAllSubmissions(platform) {
            const response = await fetch(`/teacher/api/all-submissions?platform=${platform}`);
            const result = await response.json();
            
            const container = document.getElementById(`${platform}-list`);
            
            if (result.success && result.submissions.length > 0) {
                container.innerHTML = `<table class="table">
                    <thead><tr><th>학생</th><th>프로젝트</th><th>제출일</th><th>액션</th></tr></thead>
                    <tbody>${result.submissions.map(sub => `
                        <tr>
                            <td>${sub.user_name}</td>
                            <td>${sub.project_name}</td>
                            <td>${new Date(sub.submitted_at).toLocaleString('ko-KR')}</td>
                            <td>
                                <a href="${sub.s3_url}" class="btn btn-sm btn-primary" download>다운로드</a>
                            </td>
                        </tr>
                    `).join('')}</tbody>
                </table>`;
            } else {
                container.innerHTML = '<p class="text-muted">제출물이 없습니다.</p>';
            }
        }
        
        loadAllSubmissions('entry');
    </script>
</body>
</html>
