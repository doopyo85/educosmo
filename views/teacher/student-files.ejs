<%
// Layout Data ì„¤ì •
var layoutData = {
    title: 'í•™ìƒ íŒŒì¼ ê´€ë¦¬ - Teacher',
    sidebarType: 'teacher',
    currentView: 'student-files',
    additionalCSS: [
        '/css/admin/s3-browser.css',
        '/css/admin/s3-browser-teacher.css'
    ],
    additionalJS: [
        '/js/components/S3Explorer.js'
    ],
    body: renderBody()
};

function renderBody() {
%>
<!-- ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ (í˜ì´ì§€ ì „ìš©) -->
<style>
    body {
        background: #f8f9fa;
    }

    .page-header {
        background: #fff;
        padding: 20px;
        margin-bottom: 20px;
        border-bottom: 1px solid #dee2e6;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
</style>

<!-- í˜ì´ì§€ í—¤ë” -->
<div class="page-header">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h2>ğŸ‘¥ í•™ìƒ íŒŒì¼ ê´€ë¦¬</h2>
            <p class="text-muted mb-0">ì†Œì† í•™ìƒë“¤ì˜ ì €ì¥ íŒŒì¼ì„ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
        <div>
            <span class="badge bg-success">
                <%= role %>
            </span>
            <span class="badge bg-secondary">ì„¼í„° ID: <%= centerID %></span>
        </div>
    </div>
</div>

<!-- ì•ˆë‚´ ë©”ì‹œì§€ -->
<div class="alert alert-info alert-dismissible fade show" role="alert">
    <strong>ğŸ’¡ ì‚¬ìš© ì•ˆë‚´:</strong>
    <ul class="mb-0 mt-2">
        <li>ì™¼ìª½ í´ë” íŠ¸ë¦¬ì—ì„œ í•™ìƒ í´ë”ë¥¼ í´ë¦­í•˜ì„¸ìš”</li>
        <li>í”Œë«í¼ í´ë”(scratch, entry ë“±)ë¥¼ í´ë¦­í•˜ì—¬ ì§„ì…í•˜ì„¸ìš”</li>
        <li>draft ë˜ëŠ” final í´ë” ì•ˆì— íŒŒì¼ì´ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤</li>
        <li>íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ë¯¸ë¦¬ë³´ê¸°ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤ (ì—…ë¡œë“œ/ì‚­ì œëŠ” ë¶ˆê°€)</li>
    </ul>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
</div>

<!-- S3 ë¸Œë¼ìš°ì € -->
<div id="s3-browser"></div>

<!-- ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        console.log('ğŸš€ Teacher S3 Browser ì´ˆê¸°í™” ì‹œì‘...');

        // Teacherìš© S3 Explorer ìƒì„±
        window.s3Explorer = new S3Explorer({
            containerId: 's3-browser',
            apiEndpoint: '/api/s3/browse',
            scope: 'center',                 // ì„¼í„° ì†Œì† í•™ìƒë§Œ
            rootPath: 'users/',              // users/ì—ì„œ ì‹œì‘
            userID: '<%= userID %>',         // ğŸ”¥ userID ì „ë‹¬
            userRole: '<%= role %>',         // ğŸ”¥ userRole ì „ë‹¬
            centerID: '<%= centerID %>',     // ğŸ”¥ centerID ì „ë‹¬
            allowedPlatforms: ['scratch', 'entry', 'gallery', 'portfolio'],
            enableUpload: false,             // ì—…ë¡œë“œ ë¶ˆê°€
            enableDelete: false,             // ì‚­ì œ ë¶ˆê°€
            enablePreview: true,             // ë¯¸ë¦¬ë³´ê¸° í™œì„±í™”

            onError: function (error) {
                console.error('âŒ ì˜¤ë¥˜ ë°œìƒ:', error);
                showNotification('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'danger');
            }
        });

        console.log('âœ… Teacher S3 Browser ì´ˆê¸°í™” ì™„ë£Œ');
    });

    /**
     * ì•Œë¦¼ í‘œì‹œ
     */
    function showNotification(message, type = 'info') {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
        alertDiv.style.cssText = 'position: fixed; top: 80px; right: 20px; z-index: 9999; min-width: 300px;';
        alertDiv.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        document.body.appendChild(alertDiv);

        setTimeout(() => {
            alertDiv.remove();
        }, 5000);
    }
</script>

<%
}
%>

<%- include('../layouts/board-base-layout', layoutData) %>
