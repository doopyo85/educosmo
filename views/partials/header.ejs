<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏΩîÎî©Ïï§ÌîåÎ†àÏù¥ - ÏâΩÍ≤å Î∞∞Ïö∞Îäî ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/board-notification.css">
    <script src="https://apis.google.com/js/api.js"></script>

    <!-- ÌïÑÏöîÌïú hidden input ÏöîÏÜå Ï∂îÍ∞Ä -->
    <input type="hidden" id="googleApiKey" value="<%= process.env.GOOGLE_API_KEY %>">
    <input type="hidden" id="spreadsheetId" value="<%= process.env.SPREADSHEET_ID %>">
    <input type="hidden" id="discoveryDocs" value="<%= process.env.DISCOVERY_DOCS %>">
    <input type="hidden" id="currentUserID" value="<%= locals.userID || 'Í≤åÏä§Ìä∏' %>">
    <input type="hidden" id="currentUserRole" value="<%= locals.role || 'guest' %>">

    <!-- Favicon ÏÑ§Ï†ï -->
    <link rel="icon" href="/resource/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/resource/favicon.ico" type="image/x-icon">
</head>

<header class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="<%= locals.userID === 'nuri' ? '#' : '/' %>"
            <%=locals.userID==='nuri' ? 'style="cursor: default;" onclick="return false;"' : '' %>>
            <% if (serviceType==='cosmoedu' ) { %>
                <img src="/resource/cosmoedu.webp" alt="ÏΩîÏä§Î™®ÏóêÎìÄ Î°úÍ≥†" onerror="this.src='/resource/codingnplay_logo.png'">
                <% } else { %>
                    <img src="/resource/codingnplay_logo.png" alt="ÏΩîÎî©Ïï§ÌîåÎ†àÏù¥ Î°úÍ≥†">
                    <% } %>
        </a>

        <!-- üî• ÏÑºÌÑ∞Î™Ö ÌëúÏãú (Î°úÍ∑∏Ïù∏ Ïãú) -->
        <% if (locals.centerName) { %>
            <span class="ms-2 badge bg-dark text-white" style="font-size: 0.9rem; font-weight: 500;">
                <%= locals.centerName %>
            </span>
            <% } %>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                    aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarContent">
                    <!-- üî• Mobile Context Menu for Lessons (Only visible on Kinder page) -->
                    <% if (typeof lessonTabs !=='undefined' && lessonTabs.length> 0) { %>
                        <div class="d-lg-none py-2 border-bottom mb-2 bg-white rounded px-2 shadow-sm mx-2 mt-2">
                            <strong class="px-2 text-primary small d-block mb-1"
                                style="font-family: 'Jua', sans-serif;">ÏàòÏóÖ Î∞îÎ°úÍ∞ÄÍ∏∞</strong>
                            <ul class="nav flex-column">
                                <% lessonTabs.forEach(function(tab, index) { %>
                                    <li class="nav-item">
                                        <a class="nav-link py-2 px-3 text-dark d-flex align-items-center" href="#"
                                            onclick="if(typeof switchMainTab === 'function') { switchMainTab('lessons'); const tabBtn = document.getElementById('<%= tab.id %>-tab'); if(tabBtn) { tabBtn.click(); window.scrollTo(0,0); document.querySelector('.navbar-toggler').click(); } } return false;"
                                            style="border-radius: 10px; transition: background 0.2s;">
                                            <i class="bi bi-bookmark-star-fill me-2 text-warning"></i>
                                            <span style="font-family: 'Gamja Flower', cursive; font-size: 1.1rem;">
                                                <%= tab.title %>
                                            </span>
                                        </a>
                                    </li>
                                    <% }); %>
                            </ul>
                        </div>
                        <% } %>
                            <!-- Í≤ÄÏÉâÏ∞Ω ÏÇ≠Ï†ú ÏöîÏ≤≠ÏúºÎ°ú Ïù∏Ìïú Ï£ºÏÑù Ï≤òÎ¶¨ ÎòêÎäî Ï†úÍ±∞ -->
                            <!-- 
            <form class="d-flex mx-auto" style="max-width: 400px;">
                <input class="form-control me-2" type="search" placeholder="Search..." aria-label="Search" style="font-size: 16px; padding: 8px;">
            </form>
            -->
                            <div class="mx-auto"></div> <!-- ÎßàÏßÑ Ïò§ÌÜ†Î°ú Ïö∞Ï∏° Ï†ïÎ†¨ Ïú†ÏßÄ -->
                            <% if (role==='admin' ) { %>
                                <div class="board-notification-wrapper">
                                    <button class="board-icon-btn" onclick="goToAdmin()" title="Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú"
                                        aria-label="Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥ÎìúÎ°ú Ïù¥Îèô">
                                        <i class="bi bi-gear-fill" aria-hidden="true"></i>
                                    </button>
                                    <div class="board-tooltip">Í¥ÄÎ¶¨Ïûê</div>
                                </div>
                                <% } %>
                                    <% if (role==='admin' || role==='teacher' || role==='manager' ) { %>
                                        <div class="board-notification-wrapper">
                                            <button class="board-icon-btn" onclick="goToTeacher()" title="ÍµêÏÇ¨ Ï†ÑÏö© ÌéòÏù¥ÏßÄ"
                                                aria-label="ÍµêÏÇ¨ Ï†ÑÏö© ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô">
                                                <i class="bi bi-people-fill" aria-hidden="true"></i>
                                            </button>
                                            <div class="board-tooltip">ÍµêÏÇ¨ Ï†ÑÏö©</div>
                                        </div>
                                        <% } %>
                                            <div class="d-flex align-items-center">
                                                <!-- Í≤åÏãúÌåê ÏïÑÏù¥ÏΩò (ÏÉà Í∏Ä ÏïåÎ¶º Ìè¨Ìï®) -->
                                                <% if (locals.userID !=='nuri' ) { %>
                                                    <div class="board-notification-wrapper">
                                                        <button class="board-icon-btn" onclick="goToBoard()" title="Í≤åÏãúÌåê"
                                                            aria-label="Í≤åÏãúÌåêÏúºÎ°ú Ïù¥Îèô">
                                                            <i class="bi bi-chat-square-text" aria-hidden="true"></i>
                                                            <span class="new-post-badge" id="newPostBadge"
                                                                aria-label="ÏÉà Í∏Ä Í∞úÏàò">0</span>
                                                        </button>
                                                        <div class="board-tooltip">ÏÉà Í∏Ä ÌôïÏù∏</div>
                                                    </div>

                                                    <!-- üî• ÎÇ¥ ÌååÏùº ÏïÑÏù¥ÏΩò (Ï†ÑÏ≤¥ ÏÇ¨Ïö©Ïûê) -->
                                                    <div class="board-notification-wrapper">
                                                        <% let s3Link='/s3/browser' ; if (role==='teacher' ||
                                                            role==='manager' ) { s3Link='/s3/student-files' ; } else if
                                                            (role==='student' ) { s3Link='/s3/my-files' ; } %>
                                                            <a class="board-icon-btn d-flex align-items-center justify-content-center text-decoration-none"
                                                                href="<%= s3Link %>" title="ÎÇ¥ ÌååÏùº Í¥ÄÎ¶¨"
                                                                aria-label="ÎÇ¥ ÌååÏùº Í¥ÄÎ¶¨Î°ú Ïù¥Îèô">
                                                                <i class="bi bi-folder-fill" aria-hidden="true"></i>
                                                            </a>
                                                            <div class="board-tooltip">ÎÇ¥ ÌååÏùº</div>
                                                    </div>

                                                    <!-- üî• Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ (ÌïôÏÉù Ï†ÑÏö©) -->
                                                    <% if (role==='student' ) { %>
                                                        <div class="board-notification-wrapper">
                                                            <a href="/my-universe"
                                                                class="board-icon-btn d-flex align-items-center justify-content-center text-dark text-decoration-none"
                                                                title="ÎÇòÏùò ÌïôÏäµÏù¥Î†•" aria-label="ÎÇòÏùò ÌïôÏäµÏù¥Î†• Î≥¥Í∏∞">
                                                                <i class="bi bi-clock-history" aria-hidden="true"></i>
                                                            </a>
                                                            <div class="board-tooltip">ÎÇòÏùò ÌïôÏäµ</div>
                                                        </div>
                                                        <% } %>
                                                            <% } %>

                                                                <% if (role==='admin' || role==='teacher' ||
                                                                    role==='manager' ) { %>
                                                                    <div class="nav-item dropdown me-4">
                                                                        <a class="nav-link dropdown-toggle" href="#"
                                                                            id="teacherResourcesDropdown" role="button"
                                                                            data-bs-toggle="dropdown"
                                                                            aria-expanded="false">
                                                                            ÍµêÏÇ¨ Ï†ÑÏö©ÌéòÏù¥ÏßÄ
                                                                        </a>
                                                                        <ul class="dropdown-menu"
                                                                            aria-labelledby="teacherResourcesDropdown">
                                                                            <li>
                                                                                <a class="dropdown-item"
                                                                                    href="https://shop.codingnplay.co.kr/"
                                                                                    target="_blank">
                                                                                    <img src="/resource/imweb.png"
                                                                                        alt="ÍµêÏû¨" width="20" height="20"
                                                                                        class="me-2"> ÍµêÏû¨Î™∞
                                                                                </a>
                                                                            </li>
                                                                            <li>
                                                                                <a class="dropdown-item"
                                                                                    href="https://www.miricanvas.com/workspace/team/drive"
                                                                                    target="_blank">
                                                                                    <img src="/resource/miricanvas.png"
                                                                                        alt="ÌôçÎ≥¥" width="20" height="20"
                                                                                        class="me-2"> ÌôçÎ≥¥Î¨º
                                                                                </a>
                                                                            </li>
                                                                            <li>
                                                                                <a class="dropdown-item"
                                                                                    href="http://naver.me/5YwLMZzj"
                                                                                    target="_blank">
                                                                                    <img src="/resource/navermybox.jpg"
                                                                                        alt="Ïö¥ÏòÅÏûêÎ£å" width="20"
                                                                                        height="20" class="me-2"> Ïö¥ÏòÅÏûêÎ£å
                                                                                </a>
                                                                            </li>
                                                                            <li>
                                                                                <a class="dropdown-item"
                                                                                    href="https://edu.codingnplay.co.kr/"
                                                                                    target="_blank">
                                                                                    <img src="/resource/glide.png"
                                                                                        alt="ÏßÄÎèÑÏÑú ÏòÅÏÉÅÎ≥¥Í∏∞" width="20"
                                                                                        height="20" class="me-2"> ÏßÄÎèÑÏÑú
                                                                                    ÏòÅÏÉÅÎ≥¥Í∏∞
                                                                                </a>
                                                                            </li>
                                                                            <li>
                                                                                <a class="dropdown-item"
                                                                                    href="https://app.codingnplay.co.kr/report/books-page">
                                                                                    <i
                                                                                        class="bi bi-clipboard-check me-2"></i>
                                                                                    ÌèâÍ∞ÄÏßÄ Ï∂úÎ†•
                                                                                </a>
                                                                            </li>
                                                                            <li>
                                                                                <a class="dropdown-item"
                                                                                    href="https://codingnplay.co.kr/%ec%bd%94%ed%94%8c%ec%86%8c%ec%8b%9d/"
                                                                                    target="_blank">
                                                                                    <i class="bi bi-award me-2"></i>
                                                                                    ÏûêÍ≤©Ï¶ù/ÌñâÏÇ¨
                                                                                </a>
                                                                            </li>
                                                                            <li>
                                                                                <a class="dropdown-item"
                                                                                    href="https://us02web.zoom.us/j/3566471255?pwd=U3hGeFJ4dVZnYlRVNThTcHVKbUxTUT09"
                                                                                    target="_blank">
                                                                                    <img src="/resource/zoom.png"
                                                                                        alt="Ï§å ÌöåÏùòÏã§" width="20"
                                                                                        height="20" class="me-2"> Ï§å
                                                                                    ÌöåÏùòÏã§
                                                                                </a>
                                                                            </li>

                                                                        </ul>
                                                                    </div>
                                                                    <% } %>

                                                                        <!-- ÌîÑÎ°úÌïÑ ÎìúÎ°≠Îã§Ïö¥ -->
                                                                        <div class="nav-item dropdown">
                                                                            <a class="nav-link dropdown-toggle d-flex align-items-center"
                                                                                href="#" id="profileDropdown"
                                                                                role="button" data-bs-toggle="dropdown"
                                                                                aria-expanded="false"
                                                                                style="padding: 0;">
                                                                                <img src="/resource/profiles/default.webp"
                                                                                    alt="Profile" id="profileImage"
                                                                                    class="rounded-circle"
                                                                                    style="width: 40px; height: 40px;">
                                                                                <span id="userName" class="ms-2">
                                                                                    <%= locals.userID || 'Í≤åÏä§Ìä∏' %>
                                                                                </span>
                                                                            </a>

                                                                            <% function canAccess(feature) { const
                                                                                permissions=require('../../lib_login/permissions');
                                                                                return
                                                                                permissions.hasFeatureAccess(locals.role,
                                                                                feature); } %>

                                                                                <ul class="dropdown-menu dropdown-menu-end"
                                                                                    aria-labelledby="profileDropdown">
                                                                                    <li class="px-3 py-2 text-muted">
                                                                                        <div
                                                                                            class="d-flex align-items-center">
                                                                                            <img src="/resource/profiles/default.webp"
                                                                                                alt="Profile"
                                                                                                id="profileDropdownImage"
                                                                                                class="rounded-circle"
                                                                                                style="width: 50px; height: 50px;">
                                                                                            <div class="ms-3">
                                                                                                <div id="profileDropdownUserID"
                                                                                                    style="font-weight: 500;">
                                                                                                    <%= locals.userID
                                                                                                        || 'Í≤åÏä§Ìä∏' %>
                                                                                                </div>
                                                                                                <div class="small text-muted"
                                                                                                    id="profileDropdownRole">
                                                                                                    <%= locals.role
                                                                                                        || 'guest' %>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </li>
                                                                                    <li>
                                                                                        <hr class="dropdown-divider">
                                                                                    </li>
                                                                                    <li>
                                                                                        <button class="dropdown-item"
                                                                                            type="button"
                                                                                            data-bs-toggle="modal"
                                                                                            data-bs-target="#profileModal">
                                                                                            <i
                                                                                                class="bi bi-person-fill me-2"></i>ÌîÑÎ°úÌïÑ
                                                                                            ÏÑ†ÌÉù
                                                                                        </button>
                                                                                    </li>
                                                                                    <li>
                                                                                        <a class="dropdown-item"
                                                                                            href="#"
                                                                                            onclick="openMyInfoModal(); return false;">
                                                                                            <i
                                                                                                class="bi bi-pencil-square me-2"></i>ÎÇ¥
                                                                                            Ï†ïÎ≥¥
                                                                                            ÏàòÏ†ï
                                                                                        </a>
                                                                                    </li>
                                                                                    <% if (role === 'manager') { %>
                                                                                    <li>
                                                                                        <a class="dropdown-item"
                                                                                            href="#"
                                                                                            onclick="openCenterInfoModal(); return false;">
                                                                                            <i
                                                                                                class="bi bi-building me-2"></i>ÏÑºÌÑ∞
                                                                                            Ï†ïÎ≥¥
                                                                                        </a>
                                                                                    </li>
                                                                                    <% } %>
                                                                                    <li>
                                                                                        <a class="dropdown-item"
                                                                                            href="/extension-guide">
                                                                                            <i
                                                                                                class="bi bi-puzzle me-2"></i>Extension
                                                                                            Í∞ÄÏù¥Îìú
                                                                                        </a>
                                                                                    </li>
                                                                                    <li>
                                                                                        <a class="dropdown-item"
                                                                                            href="/logout">
                                                                                            <i
                                                                                                class="bi bi-box-arrow-right me-2"></i>Î°úÍ∑∏ÏïÑÏõÉ
                                                                                        </a>
                                                                                    </li>
                                                                                </ul>
                                                                        </div>

                                            </div>
                </div>
    </div>
</header>

<!-- ÌîÑÎ°úÌïÑ ÏÑ†ÌÉù Î™®Îã¨ -->
<div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="profileModalLabel">ÌîÑÎ°úÌïÑ ÏÑ†ÌÉù</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Í∏∞Î≥∏ ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉù -->
                <h6 class="mb-3">Í∏∞Î≥∏ ÌîÑÎ°úÌïÑ</h6>
                <div class="d-flex flex-wrap justify-content-center mb-4" id="defaultProfileContainer">
                    <!-- Í∏∞Î≥∏ ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄÎì§Ïù¥ JSÎ°ú ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                </div>

                <!-- üî• ÏÑ∏ÏÖò Ï†ïÎ≥¥ ÌëúÏãú (Heartbeat ÌôïÏù∏Ïö©) -->
                <div class="mt-4 pt-3 border-top">
                    <h6 class="mb-2 text-muted" style="font-size: 0.9rem;">
                        <i class="bi bi-clock-history me-1"></i>ÏÑ∏ÏÖò Ï†ïÎ≥¥
                    </h6>
                    <div class="d-flex justify-content-between align-items-center bg-light p-2 rounded">
                        <span class="text-secondary small">ÎÇ®ÏùÄ ÏÑ∏ÏÖò ÏãúÍ∞Ñ:</span>
                        <span id="sessionRemainingTime" class="fw-bold text-primary">ÌôïÏù∏ Ï§ë...</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Îã´Í∏∞</button>
                <button type="button" class="btn btn-primary" id="saveProfileButton">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>
</div>

<!-- ÎÇ¥ Ï†ïÎ≥¥ ÏàòÏ†ï Î™®Îã¨ -->
<div class="modal fade" id="myInfoModal" tabindex="-1" aria-labelledby="myInfoModalLabel" aria-hidden="true"
    style="z-index: 10000;">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="myInfoModalLabel">ÎÇ¥ Ï†ïÎ≥¥ ÏàòÏ†ï</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="myInfoForm">
                    <div class="row mb-3">
                        <div class="col-6">
                            <label for="infoCenterName" class="form-label">ÏÜåÏÜç ÏÑºÌÑ∞</label>
                            <input type="text" class="form-control" id="infoCenterName" readonly disabled>
                        </div>
                        <div class="col-6">
                            <label for="infoUserID" class="form-label">ÏïÑÏù¥Îîî</label>
                            <input type="text" class="form-control" id="infoUserID" readonly disabled>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-6">
                            <label for="infoName" class="form-label">Ïù¥Î¶Ñ</label>
                            <input type="text" class="form-control" id="infoName" required>
                        </div>
                        <div class="col-6">
                            <label for="infoPhone" class="form-label">Ï†ÑÌôîÎ≤àÌò∏</label>
                            <input type="tel" class="form-control" id="infoPhone">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="infoEmail" class="form-label">Ïù¥Î©îÏùº</label>
                        <input type="email" class="form-control" id="infoEmail">
                    </div>
                    <div class="mb-3">
                        <label for="infoPassword" class="form-label">ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω (Î≥ÄÍ≤ΩÏãúÏóêÎßå ÏûÖÎ†•)</label>
                        <input type="password" class="form-control" id="infoPassword" placeholder="ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏">
                    </div>
                    <div class="text-end">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ï∑®ÏÜå</button>
                        <button type="submit" class="btn btn-primary">Ï†ÄÏû•</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- ÏÑºÌÑ∞ Ï†ïÎ≥¥ Î™®Îã¨ (Manager Only) -->
<div class="modal fade" id="centerInfoModal" tabindex="-1" aria-labelledby="centerInfoModalLabel" aria-hidden="true"
    style="z-index: 10000;">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content" style="border: none; box-shadow: 0 4px 20px rgba(0,0,0,0.08);">
            <div class="modal-header" style="background: white; border-bottom: 1px solid #e5e7eb;">
                <h5 class="modal-title" id="centerInfoModalLabel" style="color: #1f2937; font-weight: 600;">
                    <i class="bi bi-building me-2" style="color: #6366f1;"></i>ÏÑºÌÑ∞ Ï†ïÎ≥¥ Í¥ÄÎ¶¨
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style="background: #fafafa; padding: 24px;">
                <!-- ÏÑºÌÑ∞ Í∏∞Î≥∏ Ï†ïÎ≥¥ + Ï¥àÎåÄ ÏΩîÎìú -->
                <div class="card mb-3" style="border: 1px solid #e5e7eb; border-radius: 8px; box-shadow: none; transition: none;">
                    <div class="card-header" style="background: white; border-bottom: 1px solid #e5e7eb; padding: 12px 16px;">
                        <h6 class="mb-0" style="color: #374151; font-weight: 600; font-size: 14px;">
                            <i class="bi bi-info-circle me-2" style="color: #6366f1;"></i>ÏÑºÌÑ∞ Ï†ïÎ≥¥ Î∞è Ï¥àÎåÄ ÏΩîÎìú
                        </h6>
                    </div>
                    <div class="card-body">
                        <!-- ÏÑºÌÑ∞ Í∏∞Î≥∏ Ï†ïÎ≥¥ -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">ÏÑºÌÑ∞Î™Ö</label>
                                <input type="text" class="form-control form-control-sm" id="centerName" readonly>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">Îã¥ÎãπÏûê</label>
                                <input type="text" class="form-control form-control-sm" id="centerContactName" readonly>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">Îã¥ÎãπÏûê Ïù¥Î©îÏùº</label>
                                <input type="email" class="form-control form-control-sm" id="centerContactEmail" readonly>
                            </div>
                        </div>

                        <hr class="my-3">

                        <!-- Ï¥àÎåÄ ÏΩîÎìú ÏÑπÏÖò -->
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="mb-0" style="color: #374151; font-weight: 600; font-size: 13px;">
                                <i class="bi bi-key me-2" style="color: #6366f1;"></i>ÏÑºÌÑ∞ Ï¥àÎåÄ ÏΩîÎìú
                            </h6>
                            <button class="btn btn-sm" onclick="generateNewCenterCode()"
                                    style="background: #6366f1; color: white; border: none; padding: 4px 10px; border-radius: 6px; font-size: 12px;">
                                <i class="bi bi-plus-circle me-1"></i>ÏÉà ÏΩîÎìú Î∞úÍ∏â
                            </button>
                        </div>
                        <div id="inviteCodesContainer">
                            <div class="text-center text-muted py-2">
                                <div class="spinner-border spinner-border-sm" role="status">
                                    <span class="visually-hidden">Î°úÎî© Ï§ë...</span>
                                </div>
                                <p class="mb-0 mt-2 small">Ï¥àÎåÄ ÏΩîÎìúÎ•º Î∂àÎü¨Ïò§Îäî Ï§ë...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Íµ¨ÎèÖ Ï†ïÎ≥¥ -->
                <div class="card" style="border: 1px solid #e5e7eb; border-radius: 8px; box-shadow: none; transition: none;">
                    <div class="card-header" style="background: white; border-bottom: 1px solid #e5e7eb; padding: 12px 16px;">
                        <h6 class="mb-0" style="color: #374151; font-weight: 600; font-size: 14px;">
                            <i class="bi bi-credit-card me-2" style="color: #6366f1;"></i>Íµ¨ÎèÖ Ï†ïÎ≥¥
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <label class="form-label fw-bold small">ÌîåÎûú ÌÉÄÏûÖ</label>
                                <div class="input-group input-group-sm">
                                    <input type="text" class="form-control" id="centerPlanType" readonly>
                                    <span class="input-group-text" id="centerStatusBadge">
                                        <span class="badge bg-success">ÌôúÏÑ±</span>
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-bold small">Ïä§ÌÜ†Î¶¨ÏßÄ Ïö©Îüâ</label>
                                <input type="text" class="form-control form-control-sm" id="centerStorageLimit" readonly>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-bold small">Íµ¨ÎèÖ ÏÉÅÌÉú</label>
                                <input type="text" class="form-control form-control-sm" id="centerSubscriptionStatus" readonly>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-bold small">Îã§Ïùå Í≤∞Ï†úÏùº</label>
                                <input type="text" class="form-control form-control-sm" id="centerNextBilling" readonly>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="background: white; border-top: 1px solid #e5e7eb;">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                        style="background: #f3f4f6; color: #374151; border: none; padding: 8px 16px; border-radius: 6px;">
                    Îã´Í∏∞
                </button>
            </div>
        </div>
    </div>
</div>



<!-- Ïä§ÌÅ¨Î¶ΩÌä∏ Î∂ÄÎ∂Ñ -->
<script defer src="/header.js"></script>
<script defer src="/js/board-notification.js"></script>

<% if (locals.userID !=='nuri' ) { %>
    <!-- ü¶ù ÎÑàÍµ¨Î¶¨ÌÜ° ÏúÑÏ†Ø -->
    <%- include('nuguri_widget') %>
        <% } %>

            <script>
                /**
                 * ÎÇ¥ ÌååÏùº Î™®Îã¨ Ïó¥Í∏∞ (Ïó≠Ìï†Î≥Ñ ÏûêÎèô Í≤ΩÎ°ú ÏÑ†ÌÉù)
                 */


                /**
                 * ÎÇ¥ Ï†ïÎ≥¥ ÏàòÏ†ï Î™®Îã¨ Ïó¥Í∏∞
                 */
                async function openMyInfoModal() {
                    try {
                        const response = await fetch('/api/my-profile-detail');
                        const result = await response.json();

                        if (result.success) {
                            const student = result.student;

                            // Ìèº Îç∞Ïù¥ÌÑ∞ Ï±ÑÏö∞Í∏∞
                            document.getElementById('infoCenterName').value = student.centerName || 'ÏÜåÏÜç ÏóÜÏùå';
                            document.getElementById('infoName').value = student.name || '';
                            document.getElementById('infoUserID').value = student.userID || '';
                            document.getElementById('infoEmail').value = student.email || '';
                            document.getElementById('infoPhone').value = student.phone || '';
                            document.getElementById('infoPassword').value = ''; // ÎπÑÎ∞ÄÎ≤àÌò∏ Ï¥àÍ∏∞Ìôî

                            // Î™®Îã¨ ÌëúÏãú
                            const infoModal = new bootstrap.Modal(document.getElementById('myInfoModal'));
                            infoModal.show();
                        } else {
                            alert('Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + result.message);
                        }
                    } catch (error) {
                        console.error('ÌîÑÎ°úÌïÑ Î°úÎìú Ïò§Î•ò:', error);
                        alert('ÏÑúÎ≤Ñ ÌÜµÏã† Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                    }
                }

                // Ï†ïÎ≥¥ Ï†ÄÏû• Ï≤òÎ¶¨ (IIFE to prevent redeclaration error)
                (function () {
                    const myInfoForm = document.getElementById('myInfoForm');
                    if (myInfoForm) {
                        // Remove existing listener to prevent duplicates if re-run
                        const newForm = myInfoForm.cloneNode(true);
                        myInfoForm.parentNode.replaceChild(newForm, myInfoForm);

                        newForm.addEventListener('submit', async function (e) {
                            e.preventDefault();

                            const formData = {
                                name: document.getElementById('infoName').value,
                                email: document.getElementById('infoEmail').value,
                                phone: document.getElementById('infoPhone').value,
                                password: document.getElementById('infoPassword').value
                            };

                            try {
                                const response = await fetch('/api/my-profile-detail', {
                                    method: 'PUT',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify(formData)
                                });

                                const result = await response.json();
                                if (result.success) {
                                    alert('ÏàòÏ†ïÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.');

                                    // Î™®Îã¨ Îã´Í∏∞
                                    const modalEl = document.getElementById('myInfoModal');
                                    const modal = bootstrap.Modal.getInstance(modalEl);
                                    modal.hide();
                                } else {
                                    alert('ÏàòÏ†ï Ïã§Ìå®: ' + result.message);
                                }
                            } catch (error) {
                                console.error('ÌîÑÎ°úÌïÑ Ï†ÄÏû• Ïò§Î•ò:', error);
                                alert('Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                            }
                        });
                    }
                })();
            </script>