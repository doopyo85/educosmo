<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마추기 게임 플레이 - <%= locals.serviceName || '코딩앤플레이' %>
    </title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/games/pong/machu-game.css">
</head>

<body>
    <!-- 헤더 -->
    <%- include('partials/header') %>

        <div class="container-fluid game-play-container">
            <!-- 게임 설정 화면 -->
            <div id="game-setup" class="game-setup-screen">
                <div class="text-center py-5">
                    <h2 id="series-title">시리즈 로딩 중...</h2>
                    <p id="series-description" class="text-muted"></p>

                    <div class="game-options mt-4">
                        <h4>게임 옵션 선택</h4>
                        <div class="btn-group" role="group">
                            <input type="radio" class="btn-check" name="questionCount" id="count10" value="10" checked>
                            <label class="btn btn-outline-primary" for="count10">10문제</label>

                            <input type="radio" class="btn-check" name="questionCount" id="count20" value="20">
                            <label class="btn btn-outline-primary" for="count20">20문제</label>

                            <input type="radio" class="btn-check" name="questionCount" id="countAll" value="all">
                            <label class="btn btn-outline-primary" for="countAll">전체</label>
                        </div>

                        <div class="mt-4">
                            <button id="start-game-btn" class="btn btn-success btn-lg">
                                <i class="bi bi-play"></i>
                                게임 시작
                            </button>
                            <a href="/machu" class="btn btn-secondary btn-lg ms-3">
                                <i class="bi bi-arrow-left"></i>
                                목록으로
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 게임 플레이 화면 -->
            <div id="game-play" class="game-play-screen d-none">
                <!-- 진행 표시 -->
                <div class="progress-section mb-4">
                    <div class="d-flex justify-content-between align-items-center">
                        <span id="progress-text">1 / 10</span>
                        <span id="score-text">점수: 0</span>
                    </div>
                    <div class="progress mt-2">
                        <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- 문제 이미지 -->
                <div class="question-section text-center">
                    <div class="image-container">
                        <img id="question-image" src="" alt="문제 이미지" class="question-image">
                    </div>

                    <!-- 답안 입력 -->
                    <div class="answer-section mt-4">
                        <div class="input-group input-group-lg">
                            <input type="text" id="answer-input" class="form-control" placeholder="이름을 입력하세요...">
                            <button id="submit-answer" class="btn btn-primary" type="button">
                                <i class="bi bi-check"></i>
                            </button>
                        </div>
                        <button id="hint-btn" class="btn btn-outline-secondary btn-sm mt-2">
                            <i class="bi bi-lightbulb"></i>
                            힌트
                        </button>
                    </div>

                    <!-- 결과 표시 -->
                    <div id="answer-result" class="answer-result mt-3 d-none">
                        <div id="result-message" class="alert"></div>
                        <button id="next-question" class="btn btn-success">다음 문제</button>
                    </div>
                </div>
            </div>

            <!-- 게임 결과 화면 -->
            <div id="game-result" class="game-result-screen d-none">
                <div class="text-center py-5">
                    <h2>게임 완료!</h2>
                    <div class="result-score mt-4">
                        <span id="final-score" class="display-4 text-primary">0</span>
                        <span class="h4"> / </span>
                        <span id="total-questions" class="h4">10</span>
                    </div>
                    <p id="result-message-text" class="mt-3 h5"></p>

                    <div class="mt-4">
                        <button id="play-again" class="btn btn-primary btn-lg">
                            <i class="bi bi-arrow-clockwise"></i>
                            다시 하기
                        </button>
                        <a href="/machu" class="btn btn-secondary btn-lg ms-3">
                            <i class="bi bi-house"></i>
                            홈으로
                        </a>
                    </div>
                </div>
            </div>

            <!-- 로딩 오버레이 -->
            <div id="loading-overlay" class="loading-overlay d-none">
                <div class="spinner-border text-light" role="status">
                    <span class="visually-hidden">로딩 중...</span>
                </div>
            </div>
        </div>

        <!-- 푸터 제거 - 퀴즈 게임에서는 불필요 -->

        <!-- JavaScript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            // 서버에서 전달받은 seriesId
            const SERIES_ID = '<%= seriesId %>';
        </script>
        <script src="/games/pong/machu-play.js"></script>
</body>

</html>