8070 ì—”íŠ¸ë¦¬ í—¤ë” êµ¬í˜„ ë° s3ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° ê¸°ëŠ¥êµ¬í˜„

ğŸ¯ í•´ê²° ë°©í–¥ ìš”ì•½
ëª©í‘œ: 8070ë²ˆ EntryJS ì„œë²„ì— ì™„ì „í•œ í—¤ë”/íˆ´ë°” ì¶”ê°€ + 3000ë²ˆ ì„œë²„ ì—°ë™
S3 êµ¬ì¡°: s3://bucket/users/{userID}/projects/{projectName}.ent ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ìë³„ í´ë” êµ¬ì„±
ì—°ë™ ë°©ì‹: 8070ë²ˆ â†” 3000ë²ˆ API í†µì‹ ìœ¼ë¡œ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°

ğŸ“ S3 ì €ì¥ êµ¬ì¡° ì„¤ê³„
ì œì•ˆí•˜ëŠ” S3 í´ë” êµ¬ì¡°
s3://educodingnplaycontents/
â”œâ”€â”€ ent/                           # ê¸°ì¡´ êµìœ¡ìš© ENT (ê·¸ëŒ€ë¡œ ìœ ì§€)
â”‚   â”œâ”€â”€ cpe1-1a.ent
â”‚   â””â”€â”€ cpe1-1b.ent
â””â”€â”€ users/                         # ì‹ ê·œ: ì‚¬ìš©ì ì‘í’ˆ í´ë”
    â”œâ”€â”€ {userID}/
    â”‚   â”œâ”€â”€ projects/
    â”‚   â”‚   â”œâ”€â”€ ë‚´ì²«ì‘í’ˆ.ent
    â”‚   â”‚   â”œâ”€â”€ ê²Œì„í”„ë¡œì íŠ¸.ent
    â”‚   â”‚   â””â”€â”€ metadata.json      # í”„ë¡œì íŠ¸ ëª©ë¡ ì •ë³´
    â”‚   â””â”€â”€ temp/                  # ì„ì‹œ íŒŒì¼
    â””â”€â”€ shared/                    # ê³µìœ  ì‘í’ˆ
        â””â”€â”€ public/
MySQL ì‚¬ìš©ì í”„ë¡œì íŠ¸ í…Œì´ë¸”
sqlCREATE TABLE user_projects (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id VARCHAR(255) NOT NULL,
    project_name VARCHAR(255) NOT NULL,
    s3_key VARCHAR(500) NOT NULL,           -- S3 ê²½ë¡œ
    thumbnail_url VARCHAR(500),             -- ì¸ë„¤ì¼
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    is_public BOOLEAN DEFAULT FALSE,
    INDEX idx_user_id (user_id)
);

ğŸ”§ ì½”ë“œ êµ¬í˜„
1. 8070ë²ˆ ì„œë²„ í—¤ë” ì¶”ê°€
íŒŒì¼: /var/www/html/entry/index.html ìˆ˜ì •EntryJS ì›Œí¬ìŠ¤í˜ì´ìŠ¤ + í—¤ë”ëŒ€í™”í˜• ì•„í‹°íŒ©íŠ¸Â 2. 3000ë²ˆ ì„œë²„ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
íŒŒì¼: /var/www/html/routes/api/entryUserProjectRouter.js (ì‹ ê·œ)ì‚¬ìš©ì í”„ë¡œì íŠ¸ API ë¼ìš°í„°ì½”ë“œÂ const express = require('express');
const router = express.Router();
const AWS = require('@aws-sdk/client-s3');
const tar = require('tar');
const fs = require('fs/promises');
const path = require('path');
const { v4: uuidv4 } = require('uuid');

// Sì¬ì‹œë„Dì´ì–´ì„œ ê³„ì† ì¶œë ¥í¸ì§‘ì‚¬ìš©ì í”„ë¡œì íŠ¸ API ë¼ìš°í„°ì½”ë“œâ€‚âˆ™â€‚ë²„ì „ 2Â // ì‚¬ìš©ì í”„ë¡œì íŠ¸ ë¡œë“œ
router.post('/load-user-project', async (req, res) => {
    try {
        const { userID, projectId } = req.body;
        
        if (!userID || !projectId) {
            return res.status(400).json({ 
                error: 'userIDì™€ 3. 3000ë²ˆ ì„œë²„ ë©”ì¸ ë¼ìš°í„° ì—°ê²°
íŒŒì¼: /var/www/html/routes/entryRouter.js ìˆ˜ì •ì—…ë°ì´íŠ¸ëœ Entry ë¼ìš°í„°ì½”ë“œÂ const express = require('express');
const router = express.Router();
const { authenticateUser, checkPageAccess } = require('../lib_login/authMiddleware');

// ì‚¬ìš©ì í”„ë¡œì íŠ¸ API ë¼ìš°í„° ì—°ê²°
const userProjectRouter = require('./api/entryUserProjectRouter');
rout4. MySQL í…Œì´ë¸” ìƒì„± ìŠ¤í¬ë¦½íŠ¸ì‚¬ìš©ì í”„ë¡œì íŠ¸ í…Œì´ë¸” ìƒì„±ì½”ë“œÂ -- ì‚¬ìš©ì í”„ë¡œì íŠ¸ í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS user_projects (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id VARCHAR(255) NOT NULL,
    project_name VARCHAR(255) NOT NULL,
    s3_key VARCHAR(500) NOT NULL,
    thumbnail_url VARCHAR(500),
    desc5. ì„œë²„ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸EntryJS í—¤ë” ê¸°ëŠ¥ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ì½”ë“œÂ #!/bin/bash

echo "ğŸš€ EntryJS í—¤ë” ê¸°ëŠ¥ ë°°í¬ ì‹œì‘..."

# 1. MySQL í…Œì´ë¸” ìƒì„±
echo "ğŸ“Š MySQL í…Œì´ë¸” ìƒì„±..."
mysql -u root -p educodingnplay << 'EOF'
-- ì‚¬ìš©ì í”„ë¡œì íŠ¸ í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS user_projects (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id VARCH
ğŸ¯ ë°°í¬ ë° ì„¤ì • ê°€ì´ë“œ
1. ë‹¨ê³„ë³„ ë°°í¬
bash# 1. ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
chmod +x deploy_script.sh
./deploy_script.sh

# 2. ìˆ˜ë™ìœ¼ë¡œ íŒŒì¼ ë‚´ìš© êµì²´ (ìœ„ì˜ ì•„í‹°íŒ©íŠ¸ ì½”ë“œë“¤)
# - /var/www/html/entry/index.html
# - /var/www/html/routes/api/entryUserProjectRouter.js  
# - /var/www/html/routes/entryRouter.js
2. S3 ê¶Œí•œ ì„¤ì •
bash# IAM ì‚¬ìš©ìì— ì¶”ê°€ ê¶Œí•œ í•„ìš”
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "s3:PutObject",
                "s3:GetObject", 
                "s3:DeleteObject"
            ],
            "Resource": [
                "arn:aws:s3:::educodingnplaycontents/users/*"
            ]
        }
    ]
}
3. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
bash# .env íŒŒì¼ì— ì¶”ê°€
AWS_REGION=ap-northeast-2
S3_BUCKET_NAME=educodingnplaycontents

ğŸ”§ ì£¼ìš” ê¸°ëŠ¥ ì„¤ëª…
í—¤ë” ê¸°ëŠ¥ë“¤

ìƒˆë¡œë§Œë“¤ê¸°: ë¹ˆ í”„ë¡œì íŠ¸ë¡œ ì´ˆê¸°í™”
ë¶ˆëŸ¬ì˜¤ê¸°: ì‚¬ìš©ìì˜ ì €ì¥ëœ í”„ë¡œì íŠ¸ ëª©ë¡ â†’ ì„ íƒ â†’ ë¡œë“œ
ì €ì¥í•˜ê¸°: í˜„ì¬ í”„ë¡œì íŠ¸ë¥¼ S3ì— ENT íŒŒì¼ë¡œ ì €ì¥
ë˜ëŒë¦¬ê¸°/ë‹¤ì‹œì‹¤í–‰: EntryJS ê¸°ë³¸ ê¸°ëŠ¥
ì‹¤í–‰/ì •ì§€: EntryJS ê¸°ë³¸ ê¸°ëŠ¥

S3 ì €ì¥ êµ¬ì¡°
s3://educodingnplaycontents/
â”œâ”€â”€ ent/                    # ê¸°ì¡´ êµìœ¡ìš© (ë³€ê²½ ì—†ìŒ)
â””â”€â”€ users/                  # ì‹ ê·œ ì‚¬ìš©ì í´ë”
    â””â”€â”€ {userID}/
        â””â”€â”€ projects/
            â”œâ”€â”€ í”„ë¡œì íŠ¸1_timestamp.ent
            â””â”€â”€ í”„ë¡œì íŠ¸2_timestamp.ent
ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™

MySQL: í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„° ì €ì¥
S3: ì‹¤ì œ ENT íŒŒì¼ ì €ì¥
ì‚¬ìš©ìë³„ ê´€ë¦¬: userID ê¸°ë°˜ìœ¼ë¡œ ì™„ì „ ë¶„ë¦¬

ì´ì œ ì™„ì „í•œ EntryJS ì›¹ ì—ë””í„°ê°€ êµ¬ì¶•ë©ë‹ˆë‹¤! í…ŒìŠ¤íŠ¸ í›„ ë¬¸ì œê°€ ìˆìœ¼ë©´ ì•Œë ¤ì£¼ì„¸ìš”.