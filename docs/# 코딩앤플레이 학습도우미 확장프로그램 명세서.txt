# ì½”ë”©ì•¤í”Œë ˆì´ í•™ìŠµë„ìš°ë¯¸ í™•ì¥í”„ë¡œê·¸ë¨ ëª…ì„¸ì„œ

## ğŸ“‹ ë¬¸ì„œ ì •ë³´

| í•­ëª© | ë‚´ìš© |
|------|------|
| ë¬¸ì„œëª… | ì½”ë”©ì•¤í”Œë ˆì´ í•™ìŠµë„ìš°ë¯¸ Chrome/Edge í™•ì¥í”„ë¡œê·¸ë¨ ê¸°ìˆ  ëª…ì„¸ì„œ |
| ë²„ì „ | 1.0.0 |
| ì‘ì„±ì¼ | 2025-01-02 |
| ë°°í¬ë°©ì‹ | ê°œë°œì ëª¨ë“œ (ìŠ¤í† ì–´ ë“±ë¡ ì—†ìŒ) |

---

## 1. ê°œìš”

### 1.1 ëª©ì 

ë³¸ í™•ì¥í”„ë¡œê·¸ë¨ì€ ì½”ë”©ì•¤í”Œë ˆì´ í•™ìŠµ í”Œë«í¼ì—ì„œ ì™¸ë¶€ ê³µì‹ ì½”ë”© ë„êµ¬(Entry, Scratch, App Inventor)ì™€ì˜ ì—°ë™ì„ ì§€ì›í•©ë‹ˆë‹¤. ì½”ë”©ì•¤í”Œë ˆì´ëŠ” ì—ë””í„°ë¥¼ ì§ì ‘ ì œê³µí•˜ì§€ ì•Šê³ , ê³µì‹ ì—ë””í„°ì—ì„œ ìƒì„±ëœ í•™ìŠµ ê²°ê³¼ë¬¼ë§Œì„ ìˆ˜ì§‘Â·ë¶„ì„Â·ì €ì¥í•©ë‹ˆë‹¤.

### 1.2 í•µì‹¬ ì›ì¹™

```
âŒ í•˜ì§€ ì•ŠëŠ” ê²ƒ
- ì—ë””í„° ì§ì ‘ í˜¸ìŠ¤íŒ…
- ì½”ë“œ ì‹¤í–‰ í™˜ê²½ ì œê³µ
- ì™¸ë¶€ API ìë™ í¬ë¡¤ë§

â­• í•˜ëŠ” ê²ƒ  
- ê³µì‹ ì—ë””í„°ë¡œ í”„ë¡œì íŠ¸ ì—´ê¸° (ìƒˆ ì°½)
- ì‚¬ìš©ì ëª…ì‹œì  ì œì¶œë¡œ ê²°ê³¼ íŒŒì¼ ìˆ˜ì§‘
- S3 ì €ì¥ ë° í•™ìŠµ ì´ë ¥ ê´€ë¦¬
```

### 1.3 ì§€ì› í”Œë«í¼

| í”Œë«í¼ | ê³µì‹ URL | íŒŒì¼ í˜•ì‹ | ìë™ ì¶”ì¶œ |
|--------|----------|----------|----------|
| Scratch | scratch.mit.edu | .sb3 | âœ… (ê³µìœ  í”„ë¡œì íŠ¸) |
| Entry | playentry.org | .ent |âš ï¸ íŒŒì¼ ì„ íƒ |
| App Inventor | ai2.appinventor.mit.edu | .aia | âš ï¸ íŒŒì¼ ì„ íƒ |

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 2.1 ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ì‚¬ìš©ì ë¸Œë¼ìš°ì €                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              í¬ë¡¬/ì—£ì§€ í™•ì¥í”„ë¡œê·¸ë¨                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚  â”‚  â”‚ background  â”‚  â”‚  content    â”‚  â”‚   popup     â”‚        â”‚  â”‚
â”‚  â”‚  â”‚   .js       â”‚  â”‚   .js       â”‚  â”‚   .html     â”‚        â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚         â–¼                    â–¼                    â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ playentry   â”‚      â”‚ scratch     â”‚      â”‚ appinventor â”‚      â”‚
â”‚  â”‚ .org        â”‚      â”‚ .mit.edu    â”‚      â”‚ .mit.edu    â”‚      â”‚
â”‚  â”‚ (ê³µì‹)       â”‚      â”‚ (ê³µì‹)       â”‚      â”‚ (ê³µì‹)       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼ ì œì¶œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì½”ë”©ì•¤í”Œë ˆì´ ì„œë²„                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  app.codingnplay.co.kr                                    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ /api/mission/:id      â† ê³¼ì œ ì •ë³´ ì¡°íšŒ                 â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ /api/submit           â† ì œì¶œ ë°ì´í„° ìˆ˜ì‹                â”‚  â”‚
â”‚  â”‚  â””â”€â”€ /api/upload-url       â† S3 Presigned URL ë°œê¸‰         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                  â”‚
â”‚                               â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AWS S3 (codingnplay-learning-data)                       â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ scratch/{userId}/{missionId}/                        â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ project.sb3                                      â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ metadata.json                                    â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€ screenshot.png (ì„ íƒ)                             â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ entry/{userId}/{missionId}/                          â”‚  â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ project.ent                                      â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€ metadata.json                                    â”‚  â”‚
â”‚  â”‚  â””â”€â”€ appinventor/{userId}/{missionId}/                    â”‚  â”‚
â”‚  â”‚      â”œâ”€â”€ project.aia                                      â”‚  â”‚
â”‚  â”‚      â””â”€â”€ metadata.json                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ë°ì´í„° íë¦„

```
[Phase 1: í”„ë¡œì íŠ¸ ì—´ê¸°]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. ì‚¬ìš©ìê°€ educodingnplayì—ì„œ ê³¼ì œ ì„ íƒ
2. "í”„ë¡œì íŠ¸ ì—´ê¸°" ë²„íŠ¼ í´ë¦­
3. í™•ì¥í”„ë¡œê·¸ë¨ì´ ê³¼ì œ ì •ë³´(missionId, userId, platform, templateUrl) ì €ì¥
4. í•´ë‹¹ í”Œë«í¼ ê³µì‹ ì—ë””í„°ë¥¼ ìƒˆ íƒ­ìœ¼ë¡œ ì—´ê¸°
   - Entry: https://playentry.org/ws/new (ë˜ëŠ” í…œí”Œë¦¿ URL)
   - Scratch: https://scratch.mit.edu/projects/editor
   - App Inventor: https://ai2.appinventor.mit.edu

[Phase 2: ì½”ë”© ì‘ì—…]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
5. ì‚¬ìš©ìê°€ ê³µì‹ ì—ë””í„°ì—ì„œ ì½”ë”© ì‘ì—… ìˆ˜í–‰
6. í™•ì¥í”„ë¡œê·¸ë¨ í”Œë¡œíŒ… ë²„íŠ¼ì´ í™”ë©´ì— í‘œì‹œë¨

[Phase 3: ì œì¶œ]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
7. ì‚¬ìš©ìê°€ í”Œë¡œíŒ… "ì œì¶œí•˜ê¸°" ë²„íŠ¼ í´ë¦­
8. í”Œë«í¼ë³„ íŒŒì¼ ìˆ˜ì§‘:
   - Scratch (ê³µìœ ë¨): APIë¡œ ìë™ ì¶”ì¶œ
   - Scratch (ë¹„ê³µìœ ) / Entry / App Inventor: íŒŒì¼ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸
9. ì„œë²„ì—ì„œ S3 Presigned URL ë°œê¸‰
10. íŒŒì¼ ì§ì ‘ S3 ì—…ë¡œë“œ
11. ë©”íƒ€ë°ì´í„° ì„œë²„ ì „ì†¡ â†’ DB ì €ì¥
12. ì™„ë£Œ ì•Œë¦¼
```

---

## 3. íŒŒì¼ êµ¬ì¡°

```
codingnplay-extension/
â”œâ”€â”€ manifest.json              # í™•ì¥í”„ë¡œê·¸ë¨ ì„¤ì •
â”œâ”€â”€ background.js              # ì„œë¹„ìŠ¤ ì›Œì»¤ (API í†µì‹ , ì´ë²¤íŠ¸ ì²˜ë¦¬)
â”œâ”€â”€ content.js                 # ì½˜í…ì¸  ìŠ¤í¬ë¦½íŠ¸ (í”Œë¡œíŒ… ë²„íŠ¼, íŒŒì¼ ìˆ˜ì§‘)
â”œâ”€â”€ popup/
â”‚   â”œâ”€â”€ popup.html             # íŒì—… UI
â”‚   â”œâ”€â”€ popup.css              # íŒì—… ìŠ¤íƒ€ì¼
â”‚   â””â”€â”€ popup.js               # íŒì—… ë¡œì§
â”œâ”€â”€ styles/
â”‚   â””â”€â”€ floating.css           # í”Œë¡œíŒ… ë²„íŠ¼ ìŠ¤íƒ€ì¼
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ utils.js               # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ icons/
â”‚   â”œâ”€â”€ icon16.png
â”‚   â”œâ”€â”€ icon48.png
â”‚   â””â”€â”€ icon128.png
â””â”€â”€ README.md                  # ì„¤ì¹˜ ê°€ì´ë“œ
```

---

## 4. ìƒì„¸ ëª…ì„¸

### 4.1 manifest.json

```json
{
  "manifest_version": 3,
  "name": "ì½”ë”©ì•¤í”Œë ˆì´ í•™ìŠµë„ìš°ë¯¸",
  "version": "1.0.0",
  "description": "Entry, Scratch, App Inventor ê³¼ì œ ì œì¶œ ë„ìš°ë¯¸",
  
  "permissions": [
    "activeTab",
    "storage",
    "tabs"
  ],
  
  "host_permissions": [
    "https://playentry.org/*",
    "https://scratch.mit.edu/*",
    "https://projects.scratch.mit.edu/*",
    "https://ai2.appinventor.mit.edu/*",
    "https://code.appinventor.mit.edu/*",
    "https://app.codingnplay.co.kr/*"
  ],
  
  "content_scripts": [
    {
      "matches": [
        "https://playentry.org/ws/*",
        "https://playentry.org/ws",
        "https://scratch.mit.edu/projects/*",
        "https://ai2.appinventor.mit.edu/*"
      ],
      "js": ["lib/utils.js", "content.js"],
      "css": ["styles/floating.css"],
      "run_at": "document_idle"
    },
    {
      "matches": [
        "https://app.codingnplay.co.kr/*"
      ],
      "js": ["lib/utils.js", "content-codingnplay.js"],
      "run_at": "document_idle"
    }
  ],
  
  "background": {
    "service_worker": "background.js"
  },
  
  "action": {
    "default_popup": "popup/popup.html",
    "default_icon": {
      "16": "icons/icon16.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    }
  },
  
  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  }
}
```

### 4.2 background.js (ì„œë¹„ìŠ¤ ì›Œì»¤)

```javascript
/**
 * ì½”ë”©ì•¤í”Œë ˆì´ í™•ì¥í”„ë¡œê·¸ë¨ - Background Service Worker
 * 
 * ì—­í• :
 * - ë©”ì‹œì§€ ë¼ìš°íŒ…
 * - API í†µì‹ 
 * - íƒ­ ê´€ë¦¬
 */

// ============================================
// ìƒìˆ˜ ì •ì˜
// ============================================
const CONFIG = {
  API_BASE: 'https://app.codingnplay.co.kr/api',
  PLATFORMS: {
    scratch: {
      name: 'Scratch',
      editorUrl: 'https://scratch.mit.edu/projects/editor',
      projectUrlPattern: /scratch\.mit\.edu\/projects\/(\d+)/,
      fileExtension: '.sb3'
    },
    entry: {
      name: 'Entry',
      editorUrl: 'https://playentry.org/ws/new',
      projectUrlPattern: /playentry\.org\/ws\/([a-zA-Z0-9]+)/,
      fileExtension: '.ent'
    },
    appinventor: {
      name: 'App Inventor',
      editorUrl: 'https://ai2.appinventor.mit.edu',
      projectUrlPattern: /appinventor\.mit\.edu/,
      fileExtension: '.aia'
    }
  }
};

// ============================================
// ë©”ì‹œì§€ í•¸ë“¤ëŸ¬
// ============================================
chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
  console.log('[Background] ë©”ì‹œì§€ ìˆ˜ì‹ :', message.action);
  
  switch (message.action) {
    case 'OPEN_EDITOR':
      handleOpenEditor(message.data);
      sendResponse({ success: true });
      break;
      
    case 'GET_MISSION_INFO':
      handleGetMissionInfo(sendResponse);
      return true; // ë¹„ë™ê¸° ì‘ë‹µ
      
    case 'SUBMIT_PROJECT':
      handleSubmitProject(message.data, sendResponse);
      return true; // ë¹„ë™ê¸° ì‘ë‹µ
      
    case 'GET_UPLOAD_URL':
      handleGetUploadUrl(message.data, sendResponse);
      return true; // ë¹„ë™ê¸° ì‘ë‹µ
      
    case 'FETCH_SCRATCH_PROJECT':
      handleFetchScratchProject(message.projectId, sendResponse);
      return true; // ë¹„ë™ê¸° ì‘ë‹µ
      
    default:
      console.warn('[Background] ì•Œ ìˆ˜ ì—†ëŠ” ì•¡ì…˜:', message.action);
      sendResponse({ success: false, error: 'Unknown action' });
  }
});

// ============================================
// ì—ë””í„° ì—´ê¸°
// ============================================
async function handleOpenEditor(data) {
  const { platform, missionId, userId, templateUrl, missionTitle } = data;
  
  // ê³¼ì œ ì •ë³´ ì €ì¥
  await chrome.storage.local.set({
    currentMission: {
      platform,
      missionId,
      userId,
      missionTitle,
      templateUrl,
      startedAt: new Date().toISOString()
    }
  });
  
  // ì—ë””í„° URL ê²°ì •
  let editorUrl = templateUrl || CONFIG.PLATFORMS[platform]?.editorUrl;
  
  if (!editorUrl) {
    console.error('[Background] ì•Œ ìˆ˜ ì—†ëŠ” í”Œë«í¼:', platform);
    return;
  }
  
  // ìƒˆ íƒ­ìœ¼ë¡œ ì—ë””í„° ì—´ê¸°
  chrome.tabs.create({ url: editorUrl });
  
  console.log('[Background] ì—ë””í„° ì—´ê¸°:', { platform, editorUrl, missionId });
}

// ============================================
// ê³¼ì œ ì •ë³´ ì¡°íšŒ
// ============================================
async function handleGetMissionInfo(sendResponse) {
  try {
    const result = await chrome.storage.local.get('currentMission');
    sendResponse({ 
      success: true, 
      data: result.currentMission || null 
    });
  } catch (error) {
    console.error('[Background] ê³¼ì œ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:', error);
    sendResponse({ success: false, error: error.message });
  }
}

// ============================================
// S3 ì—…ë¡œë“œ URL ë°œê¸‰
// ============================================
async function handleGetUploadUrl(data, sendResponse) {
  const { platform, missionId, userId, fileName, fileType } = data;
  
  try {
    const response = await fetch(`${CONFIG.API_BASE}/upload-url`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include',
      body: JSON.stringify({
        platform,
        missionId,
        userId,
        fileName,
        fileType
      })
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    const result = await response.json();
    sendResponse({ success: true, data: result });
    
  } catch (error) {
    console.error('[Background] ì—…ë¡œë“œ URL ë°œê¸‰ ì‹¤íŒ¨:', error);
    sendResponse({ success: false, error: error.message });
  }
}

// ============================================
// í”„ë¡œì íŠ¸ ì œì¶œ
// ============================================
async function handleSubmitProject(data, sendResponse) {
  const { platform, missionId, userId, projectUrl, s3Key, fileName } = data;
  
  try {
    const response = await fetch(`${CONFIG.API_BASE}/submit`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include',
      body: JSON.stringify({
        platform,
        missionId,
        userId,
        projectUrl,
        s3Key,
        fileName,
        submittedAt: new Date().toISOString()
      })
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    const result = await response.json();
    
    // ê³¼ì œ ì •ë³´ í´ë¦¬ì–´ (ì„ íƒì )
    // await chrome.storage.local.remove('currentMission');
    
    sendResponse({ success: true, data: result });
    
  } catch (error) {
    console.error('[Background] ì œì¶œ ì‹¤íŒ¨:', error);
    sendResponse({ success: false, error: error.message });
  }
}

// ============================================
// Scratch í”„ë¡œì íŠ¸ ë°ì´í„° ì¶”ì¶œ (ê³µìœ ëœ í”„ë¡œì íŠ¸)
// ============================================
async function handleFetchScratchProject(projectId, sendResponse) {
  try {
    const response = await fetch(
      `https://projects.scratch.mit.edu/${projectId}`,
      { method: 'GET' }
    );
    
    if (!response.ok) {
      // ê³µìœ ë˜ì§€ ì•Šì€ í”„ë¡œì íŠ¸
      sendResponse({ 
        success: false, 
        error: 'NOT_SHARED',
        message: 'í”„ë¡œì íŠ¸ê°€ ê³µìœ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. íŒŒì¼ì„ ì§ì ‘ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.'
      });
      return;
    }
    
    const data = await response.json();
    sendResponse({ success: true, data });
    
  } catch (error) {
    console.error('[Background] Scratch í”„ë¡œì íŠ¸ ì¶”ì¶œ ì‹¤íŒ¨:', error);
    sendResponse({ success: false, error: error.message });
  }
}

// ============================================
// í™•ì¥í”„ë¡œê·¸ë¨ ì„¤ì¹˜ ì‹œ
// ============================================
chrome.runtime.onInstalled.addListener((details) => {
  console.log('[Background] í™•ì¥í”„ë¡œê·¸ë¨ ì„¤ì¹˜/ì—…ë°ì´íŠ¸:', details.reason);
  
  // ì´ˆê¸° ì„¤ì •
  chrome.storage.local.set({
    extensionVersion: chrome.runtime.getManifest().version,
    installedAt: new Date().toISOString()
  });
});
```

### 4.3 content.js (ì—ë””í„° í˜ì´ì§€ìš©)

```javascript
/**
 * ì½”ë”©ì•¤í”Œë ˆì´ í™•ì¥í”„ë¡œê·¸ë¨ - Content Script (ì—ë””í„° í˜ì´ì§€)
 * 
 * ì—­í• :
 * - í”Œë¡œíŒ… ì œì¶œ ë²„íŠ¼ í‘œì‹œ
 * - í”„ë¡œì íŠ¸ íŒŒì¼ ìˆ˜ì§‘
 * - ì œì¶œ ì²˜ë¦¬
 */

(function() {
  'use strict';
  
  // ============================================
  // ìƒìˆ˜ ë° ì„¤ì •
  // ============================================
  const PLATFORMS = {
    'playentry.org': {
      id: 'entry',
      name: 'Entry',
      fileExtension: '.ent',
      exportGuide: 'íŒŒì¼ â†’ ë‚´ ì»´í“¨í„°ì— ì €ì¥í•˜ê¸°'
    },
    'scratch.mit.edu': {
      id: 'scratch', 
      name: 'Scratch',
      fileExtension: '.sb3',
      exportGuide: 'íŒŒì¼ â†’ ì»´í“¨í„°ì— ì €ì¥í•˜ê¸°'
    },
    'appinventor.mit.edu': {
      id: 'appinventor',
      name: 'App Inventor', 
      fileExtension: '.aia',
      exportGuide: 'Projects â†’ Export selected project (.aia) to my computer'
    }
  };
  
  // ============================================
  // í”Œë«í¼ ê°ì§€
  // ============================================
  function detectPlatform() {
    const hostname = window.location.hostname;
    
    for (const [domain, config] of Object.entries(PLATFORMS)) {
      if (hostname.includes(domain.split('.')[0])) {
        return config;
      }
    }
    return null;
  }
  
  // ============================================
  // í”„ë¡œì íŠ¸ ID ì¶”ì¶œ
  // ============================================
  function extractProjectId(platform) {
    const url = window.location.href;
    
    switch (platform.id) {
      case 'scratch': {
        const match = url.match(/\/projects\/(\d+)/);
        return match ? match[1] : null;
      }
      case 'entry': {
        const match = url.match(/\/ws\/([a-zA-Z0-9]+)/);
        return match ? match[1] : null;
      }
      case 'appinventor': {
        // App InventorëŠ” URLì— í”„ë¡œì íŠ¸ IDê°€ ì—†ìŒ
        return null;
      }
      default:
        return null;
    }
  }
  
  // ============================================
  // í”Œë¡œíŒ… ë²„íŠ¼ UI ìƒì„±
  // ============================================
  function createFloatingButton(platform) {
    // ì´ë¯¸ ì¡´ì¬í•˜ë©´ ìŠ¤í‚µ
    if (document.getElementById('cnp-floating-container')) {
      return;
    }
    
    const container = document.createElement('div');
    container.id = 'cnp-floating-container';
    container.innerHTML = `
      <div class="cnp-floating-wrapper">
        <div class="cnp-mission-info" id="cnp-mission-info">
          <span class="cnp-mission-badge">ê³¼ì œ ì§„í–‰ì¤‘</span>
          <span class="cnp-mission-title" id="cnp-mission-title">-</span>
        </div>
        <div class="cnp-buttons">
          <button class="cnp-btn cnp-btn-submit" id="cnp-submit-btn">
            <span class="cnp-icon">ğŸ“¤</span>
            <span class="cnp-text">ì œì¶œí•˜ê¸°</span>
          </button>
          <button class="cnp-btn cnp-btn-info" id="cnp-info-btn">
            <span class="cnp-icon">â„¹ï¸</span>
          </button>
        </div>
      </div>
      
      <!-- íŒŒì¼ ì—…ë¡œë“œ ëª¨ë‹¬ -->
      <div class="cnp-modal" id="cnp-upload-modal" style="display: none;">
        <div class="cnp-modal-backdrop"></div>
        <div class="cnp-modal-content">
          <div class="cnp-modal-header">
            <h3>ğŸ“ í”„ë¡œì íŠ¸ íŒŒì¼ ì œì¶œ</h3>
            <button class="cnp-modal-close" id="cnp-modal-close">&times;</button>
          </div>
          <div class="cnp-modal-body">
            <div class="cnp-guide">
              <p><strong>1ë‹¨ê³„:</strong> ${platform.name} ì—ë””í„°ì—ì„œ</p>
              <p class="cnp-guide-highlight">"${platform.exportGuide}"</p>
              <p><strong>2ë‹¨ê³„:</strong> ì•„ë˜ì—ì„œ ì €ì¥ëœ íŒŒì¼ ì„ íƒ</p>
            </div>
            <div class="cnp-file-input-wrapper">
              <input type="file" 
                     id="cnp-file-input" 
                     accept="${platform.fileExtension}"
                     style="display: none;" />
              <button class="cnp-btn cnp-btn-file" id="cnp-select-file-btn">
                ğŸ“‚ ${platform.fileExtension} íŒŒì¼ ì„ íƒ
              </button>
              <span class="cnp-file-name" id="cnp-file-name">ì„ íƒëœ íŒŒì¼ ì—†ìŒ</span>
            </div>
          </div>
          <div class="cnp-modal-footer">
            <button class="cnp-btn cnp-btn-cancel" id="cnp-cancel-btn">ì·¨ì†Œ</button>
            <button class="cnp-btn cnp-btn-confirm" id="cnp-confirm-btn" disabled>
              ì œì¶œí•˜ê¸°
            </button>
          </div>
        </div>
      </div>
      
      <!-- ì§„í–‰ ìƒíƒœ ëª¨ë‹¬ -->
      <div class="cnp-modal" id="cnp-progress-modal" style="display: none;">
        <div class="cnp-modal-backdrop"></div>
        <div class="cnp-modal-content cnp-modal-progress">
          <div class="cnp-spinner"></div>
          <p id="cnp-progress-text">ì œì¶œ ì¤‘...</p>
        </div>
      </div>
      
      <!-- ì™„ë£Œ ëª¨ë‹¬ -->
      <div class="cnp-modal" id="cnp-complete-modal" style="display: none;">
        <div class="cnp-modal-backdrop"></div>
        <div class="cnp-modal-content cnp-modal-complete">
          <div class="cnp-complete-icon">âœ…</div>
          <h3>ì œì¶œ ì™„ë£Œ!</h3>
          <p>ê³¼ì œê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
          <button class="cnp-btn cnp-btn-confirm" id="cnp-complete-close-btn">í™•ì¸</button>
        </div>
      </div>
    `;
    
    document.body.appendChild(container);
    
    // ì´ë²¤íŠ¸ ë°”ì¸ë”©
    bindEvents(platform);
    
    // ê³¼ì œ ì •ë³´ ë¡œë“œ
    loadMissionInfo();
  }
  
  // ============================================
  // ì´ë²¤íŠ¸ ë°”ì¸ë”©
  // ============================================
  function bindEvents(platform) {
    const submitBtn = document.getElementById('cnp-submit-btn');
    const infoBtn = document.getElementById('cnp-info-btn');
    const uploadModal = document.getElementById('cnp-upload-modal');
    const closeBtn = document.getElementById('cnp-modal-close');
    const cancelBtn = document.getElementById('cnp-cancel-btn');
    const confirmBtn = document.getElementById('cnp-confirm-btn');
    const selectFileBtn = document.getElementById('cnp-select-file-btn');
    const fileInput = document.getElementById('cnp-file-input');
    const fileNameSpan = document.getElementById('cnp-file-name');
    const completeCloseBtn = document.getElementById('cnp-complete-close-btn');
    
    let selectedFile = null;
    
    // ì œì¶œ ë²„íŠ¼ í´ë¦­
    submitBtn.addEventListener('click', async () => {
      // Scratch ê³µìœ  í”„ë¡œì íŠ¸ì¸ ê²½ìš° ìë™ ì¶”ì¶œ ì‹œë„
      if (platform.id === 'scratch') {
        const projectId = extractProjectId(platform);
        if (projectId) {
          const autoResult = await tryAutoFetchScratch(projectId);
          if (autoResult.success) {
            await submitProject(autoResult.data, platform, true);
            return;
          }
        }
      }
      
      // íŒŒì¼ ì„ íƒ ëª¨ë‹¬ í‘œì‹œ
      uploadModal.style.display = 'flex';
    });
    
    // ì •ë³´ ë²„íŠ¼ í´ë¦­
    infoBtn.addEventListener('click', () => {
      chrome.runtime.sendMessage({ action: 'GET_MISSION_INFO' }, (response) => {
        if (response?.data) {
          alert(`í˜„ì¬ ê³¼ì œ: ${response.data.missionTitle || response.data.missionId}\nì‹œì‘ ì‹œê°„: ${new Date(response.data.startedAt).toLocaleString()}`);
        } else {
          alert('ì§„í–‰ ì¤‘ì¸ ê³¼ì œê°€ ì—†ìŠµë‹ˆë‹¤.');
        }
      });
    });
    
    // ëª¨ë‹¬ ë‹«ê¸°
    closeBtn.addEventListener('click', () => {
      uploadModal.style.display = 'none';
      resetFileInput();
    });
    
    cancelBtn.addEventListener('click', () => {
      uploadModal.style.display = 'none';
      resetFileInput();
    });
    
    // íŒŒì¼ ì„ íƒ ë²„íŠ¼
    selectFileBtn.addEventListener('click', () => {
      fileInput.click();
    });
    
    // íŒŒì¼ ì„ íƒë¨
    fileInput.addEventListener('change', (e) => {
      selectedFile = e.target.files[0];
      if (selectedFile) {
        fileNameSpan.textContent = selectedFile.name;
        fileNameSpan.classList.add('selected');
        confirmBtn.disabled = false;
      } else {
        resetFileInput();
      }
    });
    
    // ì œì¶œ í™•ì¸
    confirmBtn.addEventListener('click', async () => {
      if (selectedFile) {
        uploadModal.style.display = 'none';
        await submitProject(selectedFile, platform, false);
        resetFileInput();
      }
    });
    
    // ì™„ë£Œ ëª¨ë‹¬ ë‹«ê¸°
    completeCloseBtn.addEventListener('click', () => {
      document.getElementById('cnp-complete-modal').style.display = 'none';
    });
    
    // ëª¨ë‹¬ ë°±ë“œë¡­ í´ë¦­
    document.querySelectorAll('.cnp-modal-backdrop').forEach(backdrop => {
      backdrop.addEventListener('click', () => {
        uploadModal.style.display = 'none';
        document.getElementById('cnp-complete-modal').style.display = 'none';
        resetFileInput();
      });
    });
    
    function resetFileInput() {
      selectedFile = null;
      fileInput.value = '';
      fileNameSpan.textContent = 'ì„ íƒëœ íŒŒì¼ ì—†ìŒ';
      fileNameSpan.classList.remove('selected');
      confirmBtn.disabled = true;
    }
  }
  
  // ============================================
  // ê³¼ì œ ì •ë³´ ë¡œë“œ
  // ============================================
  function loadMissionInfo() {
    chrome.runtime.sendMessage({ action: 'GET_MISSION_INFO' }, (response) => {
      const missionInfo = document.getElementById('cnp-mission-info');
      const missionTitle = document.getElementById('cnp-mission-title');
      
      if (response?.data) {
        missionTitle.textContent = response.data.missionTitle || `ê³¼ì œ #${response.data.missionId}`;
        missionInfo.style.display = 'flex';
      } else {
        missionInfo.style.display = 'none';
      }
    });
  }
  
  // ============================================
  // Scratch ìë™ ì¶”ì¶œ ì‹œë„
  // ============================================
  async function tryAutoFetchScratch(projectId) {
    return new Promise((resolve) => {
      chrome.runtime.sendMessage(
        { action: 'FETCH_SCRATCH_PROJECT', projectId },
        (response) => {
          resolve(response || { success: false });
        }
      );
    });
  }
  
  // ============================================
  // í”„ë¡œì íŠ¸ ì œì¶œ
  // ============================================
  async function submitProject(fileOrData, platform, isAutoFetch) {
    const progressModal = document.getElementById('cnp-progress-modal');
    const progressText = document.getElementById('cnp-progress-text');
    const completeModal = document.getElementById('cnp-complete-modal');
    
    try {
      progressModal.style.display = 'flex';
      progressText.textContent = 'ê³¼ì œ ì •ë³´ í™•ì¸ ì¤‘...';
      
      // ê³¼ì œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      const missionResponse = await new Promise((resolve) => {
        chrome.runtime.sendMessage({ action: 'GET_MISSION_INFO' }, resolve);
      });
      
      if (!missionResponse?.data) {
        throw new Error('ì§„í–‰ ì¤‘ì¸ ê³¼ì œê°€ ì—†ìŠµë‹ˆë‹¤. ì½”ë”©ì•¤í”Œë ˆì´ì—ì„œ ê³¼ì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
      }
      
      const { missionId, userId } = missionResponse.data;
      const projectId = extractProjectId(platform);
      const projectUrl = window.location.href;
      
      // íŒŒì¼ ë°ì´í„° ì¤€ë¹„
      let fileData, fileName, fileType;
      
      if (isAutoFetch) {
        // Scratch ìë™ ì¶”ì¶œ ë°ì´í„°
        progressText.textContent = 'í”„ë¡œì íŠ¸ ë°ì´í„° ë³€í™˜ ì¤‘...';
        const jsonString = JSON.stringify(fileOrData);
        fileData = new Blob([jsonString], { type: 'application/json' });
        fileName = `project_${projectId || Date.now()}${platform.fileExtension}`;
        fileType = 'application/json';
      } else {
        // ì‚¬ìš©ìê°€ ì„ íƒí•œ íŒŒì¼
        fileData = fileOrData;
        fileName = fileOrData.name;
        fileType = fileOrData.type || 'application/octet-stream';
      }
      
      // S3 ì—…ë¡œë“œ URL ë°œê¸‰
      progressText.textContent = 'ì—…ë¡œë“œ ì¤€ë¹„ ì¤‘...';
      const uploadUrlResponse = await new Promise((resolve) => {
        chrome.runtime.sendMessage({
          action: 'GET_UPLOAD_URL',
          data: { platform: platform.id, missionId, userId, fileName, fileType }
        }, resolve);
      });
      
      if (!uploadUrlResponse?.success) {
        throw new Error('ì—…ë¡œë“œ URL ë°œê¸‰ ì‹¤íŒ¨: ' + (uploadUrlResponse?.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
      }
      
      const { uploadUrl, s3Key } = uploadUrlResponse.data;
      
      // S3ì— íŒŒì¼ ì—…ë¡œë“œ
      progressText.textContent = 'íŒŒì¼ ì—…ë¡œë“œ ì¤‘...';
      const uploadResponse = await fetch(uploadUrl, {
        method: 'PUT',
        headers: { 'Content-Type': fileType },
        body: fileData
      });
      
      if (!uploadResponse.ok) {
        throw new Error('íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨');
      }
      
      // ì œì¶œ ì •ë³´ ì„œë²„ì— ì €ì¥
      progressText.textContent = 'ì œì¶œ ì •ë³´ ì €ì¥ ì¤‘...';
      const submitResponse = await new Promise((resolve) => {
        chrome.runtime.sendMessage({
          action: 'SUBMIT_PROJECT',
          data: { 
            platform: platform.id, 
            missionId, 
            userId, 
            projectUrl,
            projectId,
            s3Key, 
            fileName 
          }
        }, resolve);
      });
      
      if (!submitResponse?.success) {
        throw new Error('ì œì¶œ ì •ë³´ ì €ì¥ ì‹¤íŒ¨: ' + (submitResponse?.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
      }
      
      // ì™„ë£Œ
      progressModal.style.display = 'none';
      completeModal.style.display = 'flex';
      
    } catch (error) {
      console.error('[CNP] ì œì¶œ ì˜¤ë¥˜:', error);
      progressModal.style.display = 'none';
      alert('ì œì¶œ ì‹¤íŒ¨: ' + error.message);
    }
  }
  
  // ============================================
  // ì´ˆê¸°í™”
  // ============================================
  function init() {
    const platform = detectPlatform();
    
    if (!platform) {
      console.log('[CNP] ì§€ì›í•˜ì§€ ì•ŠëŠ” í”Œë«í¼');
      return;
    }
    
    console.log('[CNP] í”Œë«í¼ ê°ì§€:', platform.name);
    
    // DOM ë¡œë“œ ì™„ë£Œ í›„ ë²„íŠ¼ ìƒì„±
    if (document.readyState === 'complete') {
      createFloatingButton(platform);
    } else {
      window.addEventListener('load', () => createFloatingButton(platform));
    }
  }
  
  // ì´ˆê¸°í™” ì‹¤í–‰
  init();
  
})();
```

### 4.4 content-codingnplay.js (ì½”ë”©ì•¤í”Œë ˆì´ í˜ì´ì§€ìš©)

```javascript
/**
 * ì½”ë”©ì•¤í”Œë ˆì´ í™•ì¥í”„ë¡œê·¸ë¨ - Content Script (ì½”ë”©ì•¤í”Œë ˆì´ í˜ì´ì§€)
 * 
 * ì—­í• :
 * - "í”„ë¡œì íŠ¸ ì—´ê¸°" ë²„íŠ¼ ê°ì§€
 * - ê³¼ì œ ì •ë³´ ì¶”ì¶œ í›„ ì—ë””í„° ì—´ê¸°
 */

(function() {
  'use strict';
  
  // ============================================
  // í”„ë¡œì íŠ¸ ì—´ê¸° ë²„íŠ¼ ê°ì§€ ë° ì²˜ë¦¬
  // ============================================
  function setupProjectOpenListener() {
    // ë°©ë²• 1: íŠ¹ì • í´ë˜ìŠ¤/IDë¥¼ ê°€ì§„ ë²„íŠ¼ ê°ì§€
    document.addEventListener('click', (e) => {
      const button = e.target.closest('[data-action="open-editor"]');
      
      if (button) {
        e.preventDefault();
        
        const platform = button.dataset.platform;      // 'scratch', 'entry', 'appinventor'
        const missionId = button.dataset.missionId;
        const userId = button.dataset.userId;
        const templateUrl = button.dataset.templateUrl;
        const missionTitle = button.dataset.missionTitle;
        
        if (platform && missionId && userId) {
          chrome.runtime.sendMessage({
            action: 'OPEN_EDITOR',
            data: { platform, missionId, userId, templateUrl, missionTitle }
          });
        } else {
          console.error('[CNP] í•„ìˆ˜ ë°ì´í„° ëˆ„ë½:', { platform, missionId, userId });
        }
      }
    });
    
    console.log('[CNP] ì½”ë”©ì•¤í”Œë ˆì´ í˜ì´ì§€ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ');
  }
  
  // ============================================
  // ì „ì—­ í•¨ìˆ˜ ë…¸ì¶œ (ì„ íƒì )
  // ============================================
  window.CodingnplayExtension = {
    openEditor: function(data) {
      chrome.runtime.sendMessage({
        action: 'OPEN_EDITOR',
        data: data
      });
    }
  };
  
  // ì´ˆê¸°í™”
  setupProjectOpenListener();
  
})();
```

### 4.5 styles/floating.css

```css
/**
 * ì½”ë”©ì•¤í”Œë ˆì´ í™•ì¥í”„ë¡œê·¸ë¨ - í”Œë¡œíŒ… ë²„íŠ¼ ìŠ¤íƒ€ì¼
 */

/* ============================================
   ì»¨í…Œì´ë„ˆ
   ============================================ */
#cnp-floating-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 999999;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
}

.cnp-floating-wrapper {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 10px;
}

/* ============================================
   ê³¼ì œ ì •ë³´ ë°°ì§€
   ============================================ */
.cnp-mission-info {
  display: none;
  align-items: center;
  gap: 8px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 13px;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
  animation: cnp-slideIn 0.3s ease;
}

.cnp-mission-badge {
  background: rgba(255, 255, 255, 0.2);
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 11px;
  font-weight: 600;
}

.cnp-mission-title {
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* ============================================
   ë²„íŠ¼ ê·¸ë£¹
   ============================================ */
.cnp-buttons {
  display: flex;
  gap: 8px;
}

.cnp-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: all 0.2s ease;
  font-family: inherit;
}

.cnp-btn:hover {
  transform: translateY(-2px);
}

.cnp-btn:active {
  transform: translateY(0);
}

/* ì œì¶œ ë²„íŠ¼ */
.cnp-btn-submit {
  background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
  color: white;
  padding: 14px 24px;
  font-size: 15px;
  box-shadow: 0 4px 15px rgba(56, 239, 125, 0.4);
}

.cnp-btn-submit:hover {
  box-shadow: 0 6px 20px rgba(56, 239, 125, 0.5);
}

/* ì •ë³´ ë²„íŠ¼ */
.cnp-btn-info {
  background: white;
  color: #666;
  padding: 14px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.cnp-btn-info:hover {
  background: #f5f5f5;
}

.cnp-icon {
  font-size: 16px;
}

/* ============================================
   ëª¨ë‹¬ ê³µí†µ
   ============================================ */
.cnp-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999999;
}

.cnp-modal-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

.cnp-modal-content {
  position: relative;
  background: white;
  border-radius: 20px;
  padding: 24px;
  max-width: 400px;
  width: 90%;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  animation: cnp-modalIn 0.3s ease;
}

.cnp-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
}

.cnp-modal-header h3 {
  margin: 0;
  font-size: 18px;
  color: #333;
}

.cnp-modal-close {
  background: none;
  border: none;
  font-size: 24px;
  color: #999;
  cursor: pointer;
  padding: 0;
  line-height: 1;
}

.cnp-modal-close:hover {
  color: #333;
}

.cnp-modal-body {
  margin-bottom: 24px;
}

.cnp-modal-footer {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

/* ============================================
   íŒŒì¼ ì—…ë¡œë“œ ëª¨ë‹¬
   ============================================ */
.cnp-guide {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 20px;
}

.cnp-guide p {
  margin: 4px 0;
  font-size: 14px;
  color: #555;
}

.cnp-guide-highlight {
  background: #fff3cd;
  padding: 8px 12px;
  border-radius: 8px;
  margin: 12px 0 !important;
  font-weight: 600;
  color: #856404;
}

.cnp-file-input-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
}

.cnp-btn-file {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 12px 24px;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.cnp-file-name {
  font-size: 13px;
  color: #999;
}

.cnp-file-name.selected {
  color: #11998e;
  font-weight: 600;
}

.cnp-btn-cancel {
  background: #f5f5f5;
  color: #666;
  padding: 12px 24px;
}

.cnp-btn-confirm {
  background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
  color: white;
  padding: 12px 24px;
  box-shadow: 0 4px 15px rgba(56, 239, 125, 0.3);
}

.cnp-btn-confirm:disabled {
  background: #ccc;
  box-shadow: none;
  cursor: not-allowed;
  transform: none;
}

/* ============================================
   ì§„í–‰ ìƒíƒœ ëª¨ë‹¬
   ============================================ */
.cnp-modal-progress {
  text-align: center;
  padding: 40px;
}

.cnp-spinner {
  width: 50px;
  height: 50px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #11998e;
  border-radius: 50%;
  animation: cnp-spin 1s linear infinite;
  margin: 0 auto 20px;
}

/* ============================================
   ì™„ë£Œ ëª¨ë‹¬
   ============================================ */
.cnp-modal-complete {
  text-align: center;
  padding: 40px;
}

.cnp-complete-icon {
  font-size: 60px;
  margin-bottom: 20px;
}

.cnp-modal-complete h3 {
  margin: 0 0 8px;
  color: #11998e;
}

.cnp-modal-complete p {
  margin: 0 0 24px;
  color: #666;
}

/* ============================================
   ì• ë‹ˆë©”ì´ì…˜
   ============================================ */
@keyframes cnp-slideIn {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes cnp-modalIn {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@keyframes cnp-spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
```

### 4.6 popup/popup.html

```html
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì½”ë”©ì•¤í”Œë ˆì´</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup-container">
    <header class="popup-header">
      <img src="../icons/icon48.png" alt="ë¡œê³ " class="logo">
      <h1>ì½”ë”©ì•¤í”Œë ˆì´</h1>
    </header>
    
    <main class="popup-main">
      <section class="status-section" id="mission-status">
        <div class="status-icon">ğŸ“‹</div>
        <div class="status-content">
          <h3>ì§„í–‰ ì¤‘ì¸ ê³¼ì œ</h3>
          <p id="mission-title">ì—†ìŒ</p>
        </div>
      </section>
      
      <section class="platform-section">
        <h3>ì§€ì› í”Œë«í¼</h3>
        <div class="platform-list">
          <div class="platform-item">
            <span class="platform-icon">ğŸ±</span>
            <span>Scratch</span>
          </div>
          <div class="platform-item">
            <span class="platform-icon">ğŸ®</span>
            <span>Entry</span>
          </div>
          <div class="platform-item">
            <span class="platform-icon">ğŸ“±</span>
            <span>App Inventor</span>
          </div>
        </div>
      </section>
      
      <section class="actions-section">
        <a href="https://app.codingnplay.co.kr" target="_blank" class="action-btn primary">
          ì½”ë”©ì•¤í”Œë ˆì´ ì—´ê¸°
        </a>
      </section>
    </main>
    
    <footer class="popup-footer">
      <p>ë²„ì „ 1.0.0</p>
    </footer>
  </div>
  
  <script src="popup.js"></script>
</body>
</html>
```

### 4.7 popup/popup.css

```css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  width: 300px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.popup-container {
  background: white;
  margin: 8px;
  border-radius: 16px;
  overflow: hidden;
}

/* Header */
.popup-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}

.logo {
  width: 36px;
  height: 36px;
}

.popup-header h1 {
  font-size: 18px;
  font-weight: 600;
}

/* Main */
.popup-main {
  padding: 20px;
}

/* Status Section */
.status-section {
  display: flex;
  align-items: center;
  gap: 12px;
  background: #f8f9fa;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 20px;
}

.status-icon {
  font-size: 28px;
}

.status-content h3 {
  font-size: 12px;
  color: #999;
  margin-bottom: 4px;
}

.status-content p {
  font-size: 14px;
  font-weight: 600;
  color: #333;
}

/* Platform Section */
.platform-section h3 {
  font-size: 12px;
  color: #999;
  margin-bottom: 12px;
}

.platform-list {
  display: flex;
  gap: 8px;
}

.platform-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 12px 8px;
  background: #f8f9fa;
  border-radius: 10px;
  font-size: 12px;
  color: #666;
}

.platform-icon {
  font-size: 24px;
}

/* Actions */
.actions-section {
  margin-top: 20px;
}

.action-btn {
  display: block;
  text-align: center;
  padding: 14px;
  border-radius: 10px;
  text-decoration: none;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.2s ease;
}

.action-btn.primary {
  background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
  color: white;
}

.action-btn.primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(56, 239, 125, 0.4);
}

/* Footer */
.popup-footer {
  text-align: center;
  padding: 12px;
  background: #f8f9fa;
}

.popup-footer p {
  font-size: 11px;
  color: #999;
}
```

### 4.8 popup/popup.js

```javascript
document.addEventListener('DOMContentLoaded', () => {
  // í˜„ì¬ ê³¼ì œ ì •ë³´ ë¡œë“œ
  chrome.runtime.sendMessage({ action: 'GET_MISSION_INFO' }, (response) => {
    const missionTitle = document.getElementById('mission-title');
    
    if (response?.data) {
      missionTitle.textContent = response.data.missionTitle || `ê³¼ì œ #${response.data.missionId}`;
      missionTitle.style.color = '#11998e';
    } else {
      missionTitle.textContent = 'ì—†ìŒ';
    }
  });
});
```

### 4.9 lib/utils.js

```javascript
/**
 * ì½”ë”©ì•¤í”Œë ˆì´ í™•ì¥í”„ë¡œê·¸ë¨ - ê³µí†µ ìœ í‹¸ë¦¬í‹°
 */

const CNPUtils = {
  /**
   * Base64 ì¸ì½”ë”©
   */
  toBase64: function(str) {
    return btoa(unescape(encodeURIComponent(str)));
  },
  
  /**
   * íŒŒì¼ì„ Base64ë¡œ ì½ê¸°
   */
  readFileAsBase64: function(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = () => resolve(reader.result.split(',')[1]);
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });
  },
  
  /**
   * íŒŒì¼ì„ ArrayBufferë¡œ ì½ê¸°
   */
  readFileAsArrayBuffer: function(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = () => resolve(reader.result);
      reader.onerror = reject;
      reader.readAsArrayBuffer(file);
    });
  },
  
  /**
   * ë‚ ì§œ í¬ë§·íŒ…
   */
  formatDate: function(date) {
    const d = new Date(date);
    return d.toLocaleDateString('ko-KR', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  },
  
  /**
   * ë””ë°”ìš´ìŠ¤
   */
  debounce: function(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }
};

// ì „ì—­ ë…¸ì¶œ
if (typeof window !== 'undefined') {
  window.CNPUtils = CNPUtils;
}
```

---

## 5. ì„œë²„ API ëª…ì„¸

### 5.1 ê³¼ì œ ì •ë³´ ì¡°íšŒ

```
GET /api/mission/:missionId

Response:
{
  "missionId": "m001",
  "title": "ìŠ¤í¬ë˜ì¹˜ë¡œ ê²Œì„ ë§Œë“¤ê¸°",
  "platform": "scratch",
  "templateUrl": "https://scratch.mit.edu/projects/123456/editor",
  "description": "ì í”„ ê²Œì„ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”",
  "dueDate": "2025-01-10T23:59:59Z"
}
```

### 5.2 S3 ì—…ë¡œë“œ URL ë°œê¸‰

```
POST /api/upload-url

Request:
{
  "platform": "scratch",
  "missionId": "m001",
  "userId": "user123",
  "fileName": "project.sb3",
  "fileType": "application/octet-stream"
}

Response:
{
  "uploadUrl": "https://codingnplay-learning-data.s3.amazonaws.com/...",
  "s3Key": "scratch/user123/m001/project_1704200000000.sb3",
  "expiresIn": 3600
}
```

### 5.3 ì œì¶œ ì •ë³´ ì €ì¥

```
POST /api/submit

Request:
{
  "platform": "scratch",
  "missionId": "m001",
  "userId": "user123",
  "projectUrl": "https://scratch.mit.edu/projects/123456",
  "projectId": "123456",
  "s3Key": "scratch/user123/m001/project_1704200000000.sb3",
  "fileName": "project.sb3",
  "submittedAt": "2025-01-02T12:00:00Z"
}

Response:
{
  "success": true,
  "submissionId": "sub_abc123",
  "message": "ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

---

## 6. ì½”ë”©ì•¤í”Œë ˆì´ ì›¹ ì—°ë™

### 6.1 í”„ë¡œì íŠ¸ ì—´ê¸° ë²„íŠ¼ ì˜ˆì‹œ

```html
<!-- ì½”ë”©ì•¤í”Œë ˆì´ ê³¼ì œ í˜ì´ì§€ì—ì„œ ì‚¬ìš© -->
<button 
  data-action="open-editor"
  data-platform="scratch"
  data-mission-id="m001"
  data-user-id="user123"
  data-template-url="https://scratch.mit.edu/projects/editor"
  data-mission-title="ìŠ¤í¬ë˜ì¹˜ë¡œ ê²Œì„ ë§Œë“¤ê¸°"
  class="btn-open-editor"
>
  ğŸš€ í”„ë¡œì íŠ¸ ì—´ê¸°
</button>

<button 
  data-action="open-editor"
  data-platform="entry"
  data-mission-id="m002"
  data-user-id="user123"
  data-template-url="https://playentry.org/ws/new"
  data-mission-title="ì—”íŠ¸ë¦¬ë¡œ ì• ë‹ˆë©”ì´ì…˜ ë§Œë“¤ê¸°"
  class="btn-open-editor"
>
  ğŸš€ í”„ë¡œì íŠ¸ ì—´ê¸°
</button>

<button 
  data-action="open-editor"
  data-platform="appinventor"
  data-mission-id="m003"
  data-user-id="user123"
  data-mission-title="ì•± ì¸ë²¤í„°ë¡œ ê³„ì‚°ê¸° ë§Œë“¤ê¸°"
  class="btn-open-editor"
>
  ğŸš€ í”„ë¡œì íŠ¸ ì—´ê¸°
</button>
```

### 6.2 JavaScript API ë°©ì‹ (ì„ íƒì )

```javascript
// í™•ì¥í”„ë¡œê·¸ë¨ ì„¤ì¹˜ í™•ì¸
if (window.CodingnplayExtension) {
  // í™•ì¥í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì—ë””í„° ì—´ê¸°
  window.CodingnplayExtension.openEditor({
    platform: 'scratch',
    missionId: 'm001',
    userId: 'user123',
    missionTitle: 'ìŠ¤í¬ë˜ì¹˜ë¡œ ê²Œì„ ë§Œë“¤ê¸°',
    templateUrl: 'https://scratch.mit.edu/projects/editor'
  });
} else {
  // í™•ì¥í”„ë¡œê·¸ë¨ ë¯¸ì„¤ì¹˜ ì‹œ ì•ˆë‚´
  alert('ì½”ë”©ì•¤í”Œë ˆì´ í™•ì¥í”„ë¡œê·¸ë¨ì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.');
  window.open('/extension-guide', '_blank');
}
```

---

## 7. ì„¤ì¹˜ ê°€ì´ë“œ

### 7.1 ê°œë°œì ëª¨ë“œ ì„¤ì¹˜ (Chrome)

```
1. í™•ì¥í”„ë¡œê·¸ë¨ í´ë” ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œ

2. Chrome ë¸Œë¼ìš°ì € ì—´ê¸°
   â†’ ì£¼ì†Œì°½ì— chrome://extensions ì…ë ¥

3. ìš°ì¸¡ ìƒë‹¨ "ê°œë°œì ëª¨ë“œ" í† ê¸€ ON

4. "ì••ì¶•í•´ì œëœ í™•ì¥ í”„ë¡œê·¸ë¨ì„ ë¡œë“œí•©ë‹ˆë‹¤" í´ë¦­

5. ì••ì¶• í•´ì œí•œ codingnplay-extension í´ë” ì„ íƒ

6. ì„¤ì¹˜ ì™„ë£Œ! 
   â†’ ë¸Œë¼ìš°ì € ìš°ì¸¡ ìƒë‹¨ì— í™•ì¥í”„ë¡œê·¸ë¨ ì•„ì´ì½˜ í‘œì‹œ
```

### 7.2 ê°œë°œì ëª¨ë“œ ì„¤ì¹˜ (Edge)

```
1. í™•ì¥í”„ë¡œê·¸ë¨ í´ë” ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œ

2. Edge ë¸Œë¼ìš°ì € ì—´ê¸°
   â†’ ì£¼ì†Œì°½ì— edge://extensions ì…ë ¥

3. ì¢Œì¸¡ í•˜ë‹¨ "ê°œë°œì ëª¨ë“œ" í† ê¸€ ON

4. "ì••ì¶•ì„ í‘¼ í•­ëª© ë¡œë“œ" í´ë¦­

5. ì••ì¶• í•´ì œí•œ codingnplay-extension í´ë” ì„ íƒ

6. ì„¤ì¹˜ ì™„ë£Œ!
```

---

## 8. S3 ì €ì¥ êµ¬ì¡°

```
s3://codingnplay-learning-data/
â”œâ”€â”€ scratch/
â”‚   â””â”€â”€ {userId}/
â”‚       â””â”€â”€ {missionId}/
â”‚           â”œâ”€â”€ project_{timestamp}.sb3
â”‚           â””â”€â”€ metadata_{timestamp}.json
â”œâ”€â”€ entry/
â”‚   â””â”€â”€ {userId}/
â”‚       â””â”€â”€ {missionId}/
â”‚           â”œâ”€â”€ project_{timestamp}.ent
â”‚           â””â”€â”€ metadata_{timestamp}.json
â””â”€â”€ appinventor/
    â””â”€â”€ {userId}/
        â””â”€â”€ {missionId}/
            â”œâ”€â”€ project_{timestamp}.aia
            â””â”€â”€ metadata_{timestamp}.json
```

### metadata.json ì˜ˆì‹œ

```json
{
  "submissionId": "sub_abc123",
  "userId": "user123",
  "missionId": "m001",
  "platform": "scratch",
  "projectUrl": "https://scratch.mit.edu/projects/123456",
  "projectId": "123456",
  "fileName": "project.sb3",
  "fileSize": 245678,
  "submittedAt": "2025-01-02T12:00:00Z",
  "userAgent": "Mozilla/5.0..."
}
```

---

## 9. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 9.1 ì¸ì¦
- ì½”ë”©ì•¤í”Œë ˆì´ ì„¸ì…˜ ì¿ í‚¤ ê¸°ë°˜ ì¸ì¦
- API í˜¸ì¶œ ì‹œ credentials: 'include' ì‚¬ìš©
- CORS ì„¤ì •: app.codingnplay.co.kr í—ˆìš©

### 9.2 S3 ì—…ë¡œë“œ
- Presigned URL ì‚¬ìš© (ë§Œë£Œ ì‹œê°„: 1ì‹œê°„)
- ì„œë²„ì—ì„œ URL ë°œê¸‰ ì‹œ ì‚¬ìš©ì ì¸ì¦ í™•ì¸
- íŒŒì¼ í¬ê¸° ì œí•œ: 50MB

### 9.3 ë°ì´í„° ê²€ì¦
- íŒŒì¼ í™•ì¥ì ê²€ì¦
- MIME íƒ€ì… ê²€ì¦
- ì•…ì„± íŒŒì¼ ì—…ë¡œë“œ ë°©ì§€

---

## 10. í–¥í›„ í™•ì¥ ê³„íš

### Phase 2: ê³ ê¸‰ ê¸°ëŠ¥
- [ ] ìŠ¤í¬ë¦°ìƒ· ìë™ ìº¡ì²˜
- [ ] ì½”ë”© ì‹œê°„ íŠ¸ë˜í‚¹
- [ ] ì˜¤í”„ë¼ì¸ ì§€ì›

### Phase 3: ë¶„ì„ ê¸°ëŠ¥
- [ ] .sb3 / .ent / .aia íŒŒì¼ íŒŒì‹±
- [ ] ë¸”ë¡ ì‚¬ìš© í†µê³„
- [ ] ìë™ ì±„ì 

### Phase 4: ìŠ¤í† ì–´ ë“±ë¡ (ì„ íƒ)
- [ ] Chrome Web Store ë“±ë¡
- [ ] Edge Add-ons ë“±ë¡
- [ ] Firefox Add-ons ë“±ë¡

---

## 11. ë¬¸ì„œ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| 1.0.0 | 2025-01-02 | ìµœì´ˆ ì‘ì„± |

---

**ë.**
